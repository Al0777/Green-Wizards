{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _inherits from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\src\\\\components\\\\InviteDialog.js\";\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport axios from \"axios\";\nimport Dialog from \"@material-ui/core/Dialog\";\nimport * as path from \"lodash.get\";\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\nimport DialogActions from \"@material-ui/core/DialogActions\";\nimport DialogContent from \"@material-ui/core/DialogContent\";\nimport List from \"@material-ui/core/List\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Button from \"@material-ui/core/Button\";\nimport { createMuiTheme, MuiThemeProvider, withStyles } from \"@material-ui/core/styles\";\nimport Log from \"./Log\";\nimport AutoComplete from \"./AutoComplete\";\nimport Texts from \"../Constants/Texts\";\nimport withLanguage from \"./LanguageContext\";\n\nvar styles = function styles() {\n  return {\n    paper: {\n      height: \"60vh\"\n    }\n  };\n};\n\nvar theme = createMuiTheme({\n  typography: {\n    useNextVariants: true\n  },\n  overrides: {\n    MuiListItemText: {\n      primary: {\n        fontSize: \"1.4rem\"\n      }\n    },\n    MuiButton: {\n      root: {\n        fontSize: \"1.4rem\",\n        color: \"#009688\"\n      }\n    },\n    MuiDialog: {\n      paperWidthSm: {\n        width: \"80vw\",\n        maxWidth: 400\n      },\n      paperScrollPaper: {\n        maxHeight: 800\n      }\n    }\n  }\n});\n\nvar InviteDialog = /*#__PURE__*/function (_React$Component) {\n  _inherits(InviteDialog, _React$Component);\n\n  var _super = _createSuper(InviteDialog);\n\n  function InviteDialog(props) {\n    var _this;\n\n    _classCallCheck(this, InviteDialog);\n\n    _this = _super.call(this, props);\n\n    _this.handleKeyPress = function (e) {\n      var searchInput = _this.state.searchInput;\n\n      if (e.key === \"Enter\") {\n        _this.handleSearch(searchInput);\n      }\n    };\n\n    _this.handleSearch = function (val) {\n      var value = val.toLowerCase().trim();\n      var users = _this.state.users;\n      var matchingUsers = [];\n      users.forEach(function (user) {\n        if (user.name.toLowerCase().includes(value)) {\n          matchingUsers.push(user);\n        }\n      });\n\n      _this.setState({\n        searchedForInput: true,\n        searchInput: value,\n        matchingUsers: matchingUsers\n      });\n    };\n\n    _this.onInputChange = function (event) {\n      _this.setState({\n        searchInput: event.target.value,\n        searchedForInput: false\n      });\n\n      if (event.target.value === \"\") _this.handleSearch(\"\");\n    };\n\n    _this.handleInvite = function () {\n      var _this$state = _this.state,\n          inviteIds = _this$state.inviteIds,\n          inviteType = _this$state.inviteType,\n          users = _this$state.users,\n          handleClose = _this$state.handleClose;\n      var handleInvite = _this.props.handleInvite;\n\n      if (inviteIds.length > 0) {\n        if (inviteType === \"member\") {\n          handleInvite(inviteIds);\n        } else {\n          handleInvite(users.filter(function (user) {\n            return user.user_id === inviteIds[0];\n          })[0]);\n        }\n      } else {\n        handleClose();\n      }\n\n      _this.setState({\n        inviteIds: [],\n        searchInput: \"\",\n        searchedForInput: false,\n        matchingUsers: []\n      });\n    };\n\n    _this.handleSelect = function (id) {\n      var _this$state2 = _this.state,\n          inviteIds = _this$state2.inviteIds,\n          inviteType = _this$state2.inviteType;\n      var indexOf = inviteIds.indexOf(id);\n\n      if (inviteType === \"member\") {\n        if (indexOf === -1) {\n          inviteIds.push(id);\n        } else {\n          inviteIds.splice(indexOf, 1);\n        }\n      } else if (indexOf === -1) {\n        inviteIds.push(id);\n      } else {\n        inviteIds.pop();\n      }\n\n      _this.setState({\n        inviteIds: inviteIds\n      });\n    };\n\n    _this.handleClose = function () {\n      var handleClose = _this.props.handleClose;\n      handleClose();\n    };\n\n    var _inviteType = _this.props.inviteType;\n    _this.state = {\n      inviteType: _inviteType,\n      searchInput: \"\",\n      searchedForInput: false,\n      matchingUsers: [],\n      users: [],\n      inviteIds: []\n    };\n    return _this;\n  }\n\n  _createClass(InviteDialog, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var userId = JSON.parse(localStorage.getItem(\"user\")).id;\n      axios.get(\"/api/profiles?searchBy=visibility&visible=true\").then(function (res) {\n        var users = res.data.filter(function (user) {\n          return user.user_id !== userId;\n        });\n        users.forEach(function (user) {\n          user.name = \"\".concat(user.given_name, \" \").concat(user.family_name);\n        });\n\n        _this2.setState({\n          users: users\n        });\n\n        _this2.handleSearch(\"\");\n      }).catch(function (error) {\n        Log.error(error);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state3 = this.state,\n          inviteType = _this$state3.inviteType,\n          searchInput = _this$state3.searchInput,\n          searchedForInput = _this$state3.searchedForInput,\n          users = _this$state3.users,\n          matchingUsers = _this$state3.matchingUsers,\n          inviteIds = _this$state3.inviteIds;\n      var _this$props = this.props,\n          language = _this$props.language,\n          isOpen = _this$props.isOpen,\n          classes = _this$props.classes;\n      var texts = Texts[language].inviteModal;\n      var addText;\n      var header;\n\n      switch (inviteType) {\n        case \"member\":\n          header = texts.memberHeader;\n          addText = texts.invite;\n          break;\n\n        case \"parent\":\n          header = texts.parentHeader;\n          addText = texts.add;\n          break;\n\n        case \"framily\":\n          header = texts.framilyHeader;\n          addText = texts.add;\n          break;\n\n        default:\n      }\n\n      return /*#__PURE__*/React.createElement(MuiThemeProvider, {\n        theme: theme,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Dialog, {\n        onClose: this.handleClose,\n        \"aria-labelledby\": \"invite user dialog\",\n        open: isOpen,\n        classes: {\n          paper: classes.paper\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(DialogTitle, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"inviteDialogTitle\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 13\n        }\n      }, header), /*#__PURE__*/React.createElement(\"input\", {\n        className: \"inviteDialogInput\",\n        type: \"search\",\n        value: searchInput,\n        placeholder: texts.search,\n        onChange: this.onInputChange,\n        onKeyPress: this.handleKeyPress,\n        id: \"searchUserInput\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }\n      })), /*#__PURE__*/React.createElement(DialogContent, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 11\n        }\n      }, !searchedForInput ? /*#__PURE__*/React.createElement(AutoComplete, {\n        searchInput: searchInput,\n        entities: users,\n        handleSearch: this.handleSearch,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 15\n        }\n      }) : /*#__PURE__*/React.createElement(List, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 17\n        }\n      }, matchingUsers.map(function (user) {\n        var selected = inviteIds.includes(user.user_id);\n        return /*#__PURE__*/React.createElement(ListItem, {\n          button: true,\n          onClick: function onClick() {\n            return _this3.handleSelect(user.user_id);\n          },\n          key: user.user_id,\n          selected: selected,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(ListItemAvatar, {\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(Avatar, {\n          src: path(user, [\"image\", \"path\"]),\n          sizes: \"small\",\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 27\n          }\n        })), /*#__PURE__*/React.createElement(ListItemText, {\n          primary: \"\".concat(user.given_name, \" \").concat(user.family_name),\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(ListItemIcon, {\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"i\", {\n          className: \"fas fa-circle inviteSelect\",\n          style: selected ? {} : {\n            display: \"none\"\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 27\n          }\n        })));\n      }))), /*#__PURE__*/React.createElement(DialogActions, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(Button, {\n        fontSize: 20,\n        variant: \"text\",\n        onClick: this.handleClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }\n      }, texts.cancel), /*#__PURE__*/React.createElement(Button, {\n        onClick: this.handleInvite,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 13\n        }\n      }, addText))));\n    }\n  }]);\n\n  return InviteDialog;\n}(React.Component);\n\nInviteDialog.propTypes = {\n  isOpen: PropTypes.bool,\n  handleClose: PropTypes.func,\n  handleInvite: PropTypes.func,\n  inviteType: PropTypes.string,\n  language: PropTypes.string\n};\nexport default withStyles(styles)(withLanguage(InviteDialog));","map":{"version":3,"sources":["C:/Users/nucle/Documents/GitHub/Families_Share-platform/client/src/components/InviteDialog.js"],"names":["React","PropTypes","axios","Dialog","path","DialogTitle","DialogActions","DialogContent","List","Avatar","ListItem","ListItemIcon","ListItemAvatar","ListItemText","Button","createMuiTheme","MuiThemeProvider","withStyles","Log","AutoComplete","Texts","withLanguage","styles","paper","height","theme","typography","useNextVariants","overrides","MuiListItemText","primary","fontSize","MuiButton","root","color","MuiDialog","paperWidthSm","width","maxWidth","paperScrollPaper","maxHeight","InviteDialog","props","handleKeyPress","e","searchInput","state","key","handleSearch","val","value","toLowerCase","trim","users","matchingUsers","forEach","user","name","includes","push","setState","searchedForInput","onInputChange","event","target","handleInvite","inviteIds","inviteType","handleClose","length","filter","user_id","handleSelect","id","indexOf","splice","pop","userId","JSON","parse","localStorage","getItem","get","then","res","data","given_name","family_name","catch","error","language","isOpen","classes","texts","inviteModal","addText","header","memberHeader","invite","parentHeader","add","framilyHeader","search","map","selected","display","cancel","Component","propTypes","bool","func","string"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport axios from \"axios\";\r\nimport Dialog from \"@material-ui/core/Dialog\";\r\nimport * as path from \"lodash.get\";\r\nimport DialogTitle from \"@material-ui/core/DialogTitle\";\r\nimport DialogActions from \"@material-ui/core/DialogActions\";\r\nimport DialogContent from \"@material-ui/core/DialogContent\";\r\nimport List from \"@material-ui/core/List\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport ListItem from \"@material-ui/core/ListItem\";\r\nimport ListItemIcon from \"@material-ui/core/ListItemIcon\";\r\nimport ListItemAvatar from \"@material-ui/core/ListItemAvatar\";\r\nimport ListItemText from \"@material-ui/core/ListItemText\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport { createMuiTheme, MuiThemeProvider, withStyles } from \"@material-ui/core/styles\";\r\nimport Log from \"./Log\";\r\nimport AutoComplete from \"./AutoComplete\";\r\nimport Texts from \"../Constants/Texts\";\r\nimport withLanguage from \"./LanguageContext\";\r\n\r\nconst styles = () => ({\r\n  paper: { height: \"60vh\" },\r\n});\r\n\r\nconst theme = createMuiTheme({\r\n  typography: {\r\n    useNextVariants: true\r\n  },\r\n  overrides: {\r\n    MuiListItemText: {\r\n      primary: {\r\n        fontSize: \"1.4rem\"\r\n      }\r\n    },\r\n    MuiButton: {\r\n      root: {\r\n        fontSize: \"1.4rem\",\r\n        color: \"#009688\"\r\n      }\r\n    },\r\n    MuiDialog: {\r\n      paperWidthSm: {\r\n        width: \"80vw\",\r\n        maxWidth: 400\r\n      },\r\n      paperScrollPaper: {\r\n        maxHeight: 800\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\nclass InviteDialog extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const { inviteType } = this.props;\r\n    this.state = {\r\n      inviteType,\r\n      searchInput: \"\",\r\n      searchedForInput: false,\r\n      matchingUsers: [],\r\n      users: [],\r\n      inviteIds: []\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    const userId = JSON.parse(localStorage.getItem(\"user\")).id;\r\n    axios\r\n      .get(\"/api/profiles?searchBy=visibility&visible=true\")\r\n      .then(res => {\r\n        const users = res.data.filter(user => user.user_id !== userId);\r\n        users.forEach(user => {\r\n          user.name = `${user.given_name} ${user.family_name}`;\r\n        });\r\n        this.setState({ users });\r\n        this.handleSearch(\"\");\r\n      })\r\n      .catch(error => {\r\n        Log.error(error);\r\n      });\r\n  }\r\n\r\n  handleKeyPress = e => {\r\n    const { searchInput } = this.state;\r\n    if (e.key === \"Enter\") {\r\n      this.handleSearch(searchInput);\r\n    }\r\n  };\r\n\r\n  handleSearch = val => {\r\n    const value = val.toLowerCase().trim();\r\n    const { users } = this.state;\r\n    const matchingUsers = [];\r\n    users.forEach(user => {\r\n      if (user.name.toLowerCase().includes(value)) {\r\n        matchingUsers.push(user);\r\n      }\r\n    });\r\n    this.setState({\r\n      searchedForInput: true,\r\n      searchInput: value,\r\n      matchingUsers\r\n    });\r\n  };\r\n\r\n  onInputChange = event => {\r\n    this.setState({ searchInput: event.target.value, searchedForInput: false });\r\n    if (event.target.value === \"\") this.handleSearch(\"\");\r\n  };\r\n\r\n  handleInvite = () => {\r\n    const { inviteIds, inviteType, users, handleClose } = this.state;\r\n    const { handleInvite } = this.props;\r\n    if (inviteIds.length > 0) {\r\n      if (inviteType === \"member\") {\r\n        handleInvite(inviteIds);\r\n      } else {\r\n        handleInvite(users.filter(user => user.user_id === inviteIds[0])[0]);\r\n      }\r\n    } else {\r\n      handleClose();\r\n    }\r\n    this.setState({\r\n      inviteIds: [],\r\n      searchInput: \"\",\r\n      searchedForInput: false,\r\n      matchingUsers: []\r\n    });\r\n  };\r\n\r\n  handleSelect = id => {\r\n    const { inviteIds, inviteType } = this.state;\r\n    const indexOf = inviteIds.indexOf(id);\r\n    if (inviteType === \"member\") {\r\n      if (indexOf === -1) {\r\n        inviteIds.push(id);\r\n      } else {\r\n        inviteIds.splice(indexOf, 1);\r\n      }\r\n    } else if (indexOf === -1) {\r\n      inviteIds.push(id);\r\n    } else {\r\n      inviteIds.pop();\r\n    }\r\n    this.setState({ inviteIds });\r\n  };\r\n\r\n  handleClose = () => {\r\n    const { handleClose } = this.props;\r\n    handleClose();\r\n  };\r\n\r\n  render() {\r\n    const {\r\n      inviteType,\r\n      searchInput,\r\n      searchedForInput,\r\n      users,\r\n      matchingUsers,\r\n      inviteIds\r\n    } = this.state;\r\n    const { language, isOpen, classes } = this.props;\r\n    const texts = Texts[language].inviteModal;\r\n    let addText;\r\n    let header;\r\n    switch (inviteType) {\r\n      case \"member\":\r\n        header = texts.memberHeader;\r\n        addText = texts.invite;\r\n        break;\r\n      case \"parent\":\r\n        header = texts.parentHeader;\r\n        addText = texts.add;\r\n        break;\r\n      case \"framily\":\r\n        header = texts.framilyHeader;\r\n        addText = texts.add;\r\n        break;\r\n      default:\r\n    }\r\n\r\n    return (\r\n      <MuiThemeProvider theme={theme}>\r\n        <Dialog\r\n          onClose={this.handleClose}\r\n          aria-labelledby=\"invite user dialog\"\r\n          open={isOpen}\r\n          classes={{ paper: classes.paper }}\r\n        >\r\n          <DialogTitle>\r\n            <div className=\"inviteDialogTitle\">{header}</div>\r\n            <input\r\n              className=\"inviteDialogInput\"\r\n              type=\"search\"\r\n              value={searchInput}\r\n              placeholder={texts.search}\r\n              onChange={this.onInputChange}\r\n              onKeyPress={this.handleKeyPress}\r\n              id=\"searchUserInput\"\r\n            />\r\n          </DialogTitle>\r\n          <DialogContent>\r\n            {!searchedForInput ? (\r\n              <AutoComplete\r\n                searchInput={searchInput}\r\n                entities={users}\r\n                handleSearch={this.handleSearch}\r\n              />\r\n            ) : (\r\n                <List>\r\n                  {matchingUsers.map(user => {\r\n                    const selected = inviteIds.includes(user.user_id);\r\n                    return (\r\n                      <ListItem\r\n                        button\r\n                        onClick={() => this.handleSelect(user.user_id)}\r\n                        key={user.user_id}\r\n                        selected={selected}\r\n                      >\r\n                        <ListItemAvatar>\r\n                          <Avatar\r\n                            src={path(user, [\"image\", \"path\"])}\r\n                            sizes=\"small\"\r\n                          />\r\n                        </ListItemAvatar>\r\n                        <ListItemText\r\n                          primary={`${user.given_name} ${user.family_name}`}\r\n                        />\r\n                        <ListItemIcon>\r\n                          <i\r\n                            className=\"fas fa-circle inviteSelect\"\r\n                            style={selected ? {} : { display: \"none\" }}\r\n                          />\r\n                        </ListItemIcon>\r\n                      </ListItem>\r\n                    );\r\n                  })}\r\n                </List>\r\n              )}\r\n          </DialogContent>\r\n          <DialogActions>\r\n            <Button fontSize={20} variant=\"text\" onClick={this.handleClose}>\r\n              {texts.cancel}\r\n            </Button>\r\n            <Button onClick={this.handleInvite}>{addText}</Button>\r\n          </DialogActions>\r\n        </Dialog>\r\n      </MuiThemeProvider>\r\n    );\r\n  }\r\n}\r\n\r\nInviteDialog.propTypes = {\r\n  isOpen: PropTypes.bool,\r\n  handleClose: PropTypes.func,\r\n  handleInvite: PropTypes.func,\r\n  inviteType: PropTypes.string,\r\n  language: PropTypes.string\r\n};\r\n\r\nexport default withStyles(styles)(withLanguage(InviteDialog));\r\n"]},"metadata":{},"sourceType":"module"}