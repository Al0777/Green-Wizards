{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Families_Share-platform\\\\client\\\\src\\\\components\\\\TimeslotScreen.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport { withSnackbar } from \"notistack\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport PropTypes from \"prop-types\";\nimport * as path from \"lodash.get\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\nimport Texts from \"../Constants/Texts\";\nimport withLanguage from \"./LanguageContext\";\nimport ConfirmDialog from \"./ConfirmDialog\";\nimport LoadingSpinner from \"./LoadingSpinner\";\nimport TimeslotSubcribe from \"./TimeslotSubcribe\";\nimport Images from \"../Constants/Images\";\nimport Log from \"./Log\";\n\nvar styles = function styles() {\n  return {\n    avatar: {\n      width: \"3rem\",\n      height: \"3rem\"\n    }\n  };\n};\n\nvar getTimeslot = function getTimeslot(pathname) {\n  return axios.get(pathname).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return {\n      start: {\n        dateTime: \"\"\n      },\n      end: {\n        dateTime: \"\"\n      },\n      extendedProperties: {\n        shared: {\n          parents: \"[]\",\n          children: \"[]\"\n        }\n      }\n    };\n  });\n};\n\nvar getUsersChildren = function getUsersChildren(userId) {\n  return axios.get(\"/api/users/\".concat(userId, \"/children\")).then(function (response) {\n    return response.data.map(function (child) {\n      return child.child_id;\n    });\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getGroupChildren = function getGroupChildren(groupId) {\n  return axios.get(\"/api/groups/\".concat(groupId, \"/children\")).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getGroupMembers = function getGroupMembers(groupId) {\n  return axios.get(\"/api/groups/\".concat(groupId, \"/members\")).then(function (response) {\n    return response.data.filter(function (m) {\n      return m.group_accepted && m.user_accepted;\n    });\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getChildrenProfiles = function getChildrenProfiles(ids) {\n  return axios.get(\"/api/children\", {\n    params: {\n      ids: ids\n    }\n  }).then(function (response) {\n    return response.data.map(function (child) {\n      return {\n        child_id: child.child_id,\n        image: path(child, [\"image\", \"path\"]),\n        name: \"\".concat(child.given_name, \" \").concat(child.family_name),\n        given_name: child.given_name\n      };\n    });\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getParentProfiles = function getParentProfiles(ids) {\n  return axios.get(\"/api/profiles\", {\n    params: {\n      ids: ids,\n      searchBy: \"ids\"\n    }\n  }).then(function (response) {\n    return response.data.map(function (parent) {\n      return {\n        user_id: parent.user_id,\n        image: path(parent, [\"image\", \"path\"]),\n        name: \"\".concat(parent.given_name, \" \").concat(parent.family_name),\n        phone: parent.phone,\n        given_name: parent.given_name,\n        family_name: parent.family_name\n      };\n    });\n  }).catch(function (error) {\n    Log.error(error);\n    return [{\n      image: \"\",\n      name: \"\",\n      id: \"\"\n    }];\n  });\n};\n\nvar TimeslotScreen = /*#__PURE__*/function (_React$Component) {\n  _inherits(TimeslotScreen, _React$Component);\n\n  var _super = _createSuper(TimeslotScreen);\n\n  function TimeslotScreen() {\n    var _this;\n\n    _classCallCheck(this, TimeslotScreen);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n    _this.state = {\n      fetchedTimeslot: false,\n      madeChanges: false,\n      confirmDialogIsOpen: false,\n      confirmTrigger: \"\",\n      confirmData: {},\n      showParents: false,\n      showChildren: false,\n      showAdmins: false,\n      showExternals: false,\n      children: [],\n      parentProfiles: [],\n      childrenProfiles: [],\n      timeslot: {\n        extendedProperties: {\n          shared: {\n            parents: [],\n            children: []\n          }\n        }\n      },\n      adminChanges: {}\n    };\n\n    _this.handleGoBack = function () {\n      var history = _this.props.history;\n\n      if (history.length === 1) {\n        history.replace(\"/myfamiliesshare\");\n      } else {\n        history.goBack();\n      }\n    };\n\n    _this.handleMessage = function (event) {\n      var madeChanges = _this.state.madeChanges;\n      var data = JSON.parse(event.data);\n\n      if (data.action === \"confirmGoBack\") {\n        if (madeChanges) {\n          _this.handleConfirmDialogOpen(\"back\");\n        } else {\n          _this.handleGoBack();\n        }\n      }\n    };\n\n    _this.handleLink = function (link) {\n      var message = {\n        action: \"link\",\n        value: link\n      };\n\n      if (window.isNative) {\n        window.ReactNativeWebView.postMessage(JSON.stringify(message));\n      }\n    };\n\n    _this.handleEdit = function () {\n      var history = _this.props.history;\n      var pathname = history.location.pathname;\n      var route = \"\".concat(pathname, \"/edit\");\n      history.push(route);\n    };\n\n    _this.handleEmergency = function () {\n      var history = _this.props.history;\n      var pathname = history.location.pathname;\n      var timeslot = _this.state.timeslot;\n      history.push({\n        pathname: \"\".concat(pathname, \"/emergency\"),\n        state: {\n          timeslot: timeslot\n        }\n      });\n    };\n\n    _this.handleParticipantIcon = function (profile, type) {\n      if ((type === \"parents\" || type === \"admins\") && profile.phone !== undefined) {\n        return \"fas fa-phone emergencyNumber\";\n      }\n\n      if (type === \"children\") {\n        return \"fas fa-info-circle emergencyNumber\";\n      }\n\n      return \"\";\n    };\n\n    _this.handleParticipantIconClick = function (profile, type) {\n      var _this$props = _this.props,\n          history = _this$props.history,\n          enqueueSnackbar = _this$props.enqueueSnackbar,\n          language = _this$props.language;\n      var texts = Texts[language].timeslotScreen;\n\n      if (type === \"children\") {\n        history.push(\"/profiles/groupmember/children/\".concat(profile.child_id));\n      } else if (type !== \"externals\" && profile.phone !== undefined) {\n        if (window.isNative) {\n          _this.setState({\n            confirmDialogIsOpen: true,\n            confirmTrigger: \"phone\",\n            confirmData: profile\n          });\n        } else {\n          enqueueSnackbar(texts.copy, {\n            variant: \"info\"\n          });\n        }\n      }\n    };\n\n    _this.handleSave = function () {\n      var history = _this.props.history;\n      var pathname = history.location.pathname;\n\n      var _JSON$parse = JSON.parse(JSON.stringify(_this.state)),\n          timeslot = _JSON$parse.timeslot,\n          adminChanges = _JSON$parse.adminChanges;\n\n      timeslot.adminChanges = adminChanges;\n      timeslot.extendedProperties.shared.children = JSON.stringify(timeslot.extendedProperties.shared.children);\n      timeslot.extendedProperties.shared.parents = JSON.stringify(timeslot.extendedProperties.shared.parents);\n      timeslot.extendedProperties.shared.externals = JSON.stringify(timeslot.extendedProperties.shared.externals);\n      axios.patch(\"/api\".concat(pathname), _objectSpread({}, timeslot)).then(function (response) {\n        Log.info(response);\n\n        _this.handleGoBack();\n      }).catch(function (error) {\n        Log.error(error);\n      });\n    };\n\n    _this.handleConfirmDialogClose = function (choice) {\n      var _this$state = _this.state,\n          confirmTrigger = _this$state.confirmTrigger,\n          confirmData = _this$state.confirmData;\n\n      if (choice === \"agree\") {\n        if (confirmTrigger === \"phone\") {\n          window.ReactNativeWebView.postMessage(JSON.stringify({\n            action: \"phoneCall\",\n            value: confirmData.phone\n          }));\n        } else {\n          _this.handleSave();\n        }\n      } else if (confirmTrigger === \"back\") {\n        _this.handleGoBack();\n      }\n\n      _this.setState({\n        confirmDialogIsOpen: false,\n        confirmTrigger: \"\"\n      });\n    };\n\n    _this.handleConfirmDialogOpen = function (confirmTrigger) {\n      _this.setState({\n        confirmDialogIsOpen: true,\n        confirmTrigger: confirmTrigger\n      });\n    };\n\n    _this.handleSubscribe = function (id, type) {\n      var userId = JSON.parse(localStorage.getItem(\"user\")).id;\n      var _this$props2 = _this.props,\n          language = _this$props2.language,\n          enqueueSnackbar = _this$props2.enqueueSnackbar;\n      var _this$state2 = _this.state,\n          timeslot = _this$state2.timeslot,\n          childrenProfiles = _this$state2.childrenProfiles,\n          parentProfiles = _this$state2.parentProfiles,\n          adminChanges = _this$state2.adminChanges;\n      var snackMessage;\n      var texts = Texts[language].timeslotScreen;\n\n      if (timeslot.extendedProperties.shared.status !== \"completed\") {\n        if (type === \"parent\") {\n          timeslot.extendedProperties.shared.parents.push(id);\n\n          if (timeslot.userCanEdit && userId !== id) {\n            if (adminChanges[id]) {\n              adminChanges[id] += 2;\n            } else {\n              adminChanges[id] = 2;\n            }\n\n            var parentName = parentProfiles.find(function (profile) {\n              return profile.user_id === id;\n            }).given_name;\n            snackMessage = \"\".concat(texts.parentSubscribe1, \" \").concat(parentName, \" \").concat(texts.parentSubscribe2);\n          } else {\n            snackMessage = texts.userSubscribe;\n          }\n        } else {\n          var childName = childrenProfiles.find(function (profile) {\n            return profile.child_id === id;\n          }).given_name;\n          timeslot.extendedProperties.shared.children.push(id);\n          snackMessage = \"\".concat(texts.childSubscribe1, \" \").concat(childName, \" \").concat(texts.childSubscribe2);\n        }\n\n        _this.setState({\n          timeslot: timeslot,\n          madeChanges: true\n        });\n      } else {\n        snackMessage = texts.cannotEdit;\n      }\n\n      enqueueSnackbar(snackMessage, {\n        variant: \"info\"\n      });\n    };\n\n    _this.handleUnsubscribe = function (id, type) {\n      var userId = JSON.parse(localStorage.getItem(\"user\")).id;\n      var _this$props3 = _this.props,\n          language = _this$props3.language,\n          enqueueSnackbar = _this$props3.enqueueSnackbar;\n      var _this$state3 = _this.state,\n          timeslot = _this$state3.timeslot,\n          childrenProfiles = _this$state3.childrenProfiles,\n          parentProfiles = _this$state3.parentProfiles,\n          adminChanges = _this$state3.adminChanges;\n      var texts = Texts[language].timeslotScreen;\n      var snackMessage;\n\n      if (timeslot.extendedProperties.shared.status !== \"completed\") {\n        if (type === \"parent\") {\n          timeslot.extendedProperties.shared.parents = timeslot.extendedProperties.shared.parents.filter(function (subId) {\n            return subId !== id;\n          });\n\n          if (timeslot.userCanEdit && userId !== id) {\n            if (adminChanges[id]) {\n              adminChanges[id] -= 2;\n            } else {\n              adminChanges[id] = -2;\n            }\n\n            var parentName = parentProfiles.find(function (profile) {\n              return profile.user_id === id;\n            }).given_name;\n            snackMessage = \"\".concat(texts.parentUnsubscribe1, \" \").concat(parentName, \" \").concat(texts.parentUnsubscribe2);\n          } else {\n            snackMessage = texts.userUnsubscribe;\n          }\n        } else if (type === \"child\") {\n          var childName = childrenProfiles.find(function (profile) {\n            return profile.child_id === id;\n          }).given_name;\n          timeslot.extendedProperties.shared.children = timeslot.extendedProperties.shared.children.filter(function (subId) {\n            return subId !== id;\n          });\n          snackMessage = \"\".concat(texts.childUnsubscribe1, \" \").concat(childName, \" \").concat(texts.childUnsubscribe2);\n        } else {\n          timeslot.extendedProperties.shared.externals = timeslot.extendedProperties.shared.externals.filter(function (e) {\n            return e !== id;\n          });\n          snackMessage = \"\".concat(texts.parentUnsubscribe1, \" \").concat(id, \" \").concat(texts.parentUnsubscribe2);\n        }\n\n        _this.setState({\n          timeslot: timeslot,\n          madeChanges: true\n        });\n      } else {\n        snackMessage = texts.cannotEdit;\n      }\n\n      enqueueSnackbar(snackMessage, {\n        variant: \"info\"\n      });\n    };\n\n    _this.getBackNavTitle = function () {\n      var timeslot = _this.state.timeslot;\n      var start = timeslot.start,\n          end = timeslot.end;\n      return \"\".concat(moment(start.dateTime).format(\"DD MMM\"), \" \").concat(moment(start.dateTime).format(\"HH:mm\"), \"-\").concat(moment(end.dateTime).format(\"HH:mm\"));\n    };\n\n    _this.handleShowList = function (type) {\n      var _this$state4 = _this.state,\n          showParents = _this$state4.showParents,\n          showAdmins = _this$state4.showAdmins,\n          showChildren = _this$state4.showChildren,\n          showExternals = _this$state4.showExternals;\n\n      switch (type) {\n        case \"parents\":\n          _this.setState({\n            showParents: !showParents\n          });\n\n          break;\n\n        case \"children\":\n          _this.setState({\n            showChildren: !showChildren\n          });\n\n          break;\n\n        case \"admins\":\n          _this.setState({\n            showAdmins: !showAdmins\n          });\n\n          break;\n\n        case \"externals\":\n          _this.setState({\n            showExternals: !showExternals\n          });\n\n          break;\n\n        default:\n      }\n    };\n\n    _this.handleParticipantClick = function (type, profile) {\n      var history = _this.props.history;\n\n      if (type === \"children\") {\n        history.push(\"/profiles/groupmember/children/\".concat(profile.child_id));\n      } else if (type !== \"externals\") {\n        history.push(\"/profiles/\".concat(profile.user_id, \"/info\"));\n      }\n    };\n\n    _this.renderParticipants = function (type) {\n      var _this$props4 = _this.props,\n          language = _this$props4.language,\n          classes = _this$props4.classes;\n      var _this$state5 = _this.state,\n          timeslot = _this$state5.timeslot,\n          parentProfiles = _this$state5.parentProfiles,\n          showParents = _this$state5.showParents,\n          childrenProfiles = _this$state5.childrenProfiles,\n          showChildren = _this$state5.showChildren,\n          showAdmins = _this$state5.showAdmins,\n          showExternals = _this$state5.showExternals,\n          admins = _this$state5.admins;\n      var texts = Texts[language].timeslotScreen;\n      var participants;\n      var profiles;\n      var showing;\n      var participantsHeader; // let minimum;\n\n      switch (type) {\n        case \"parents\":\n          participants = timeslot.extendedProperties.shared.parents;\n          profiles = parentProfiles.filter(function (profile) {\n            return participants.includes(profile.user_id);\n          });\n          showing = showParents; // participantsHeader = `${participants.length} ${\n          //   participants.length === 1 ? texts.volunteer : texts.volunteers\n          // } ${texts.signup}`;\n          // minimum = timeslot.extendedProperties.shared.requiredParents;\n\n          participantsHeader = texts.volunteers;\n          break;\n\n        case \"children\":\n          participants = timeslot.extendedProperties.shared.children;\n          profiles = childrenProfiles.filter(function (profile) {\n            return participants.includes(profile.child_id);\n          });\n          showing = showChildren; // participantsHeader = `${participants.length} ${\n          //   participants.length === 1 ? texts.child : texts.children\n          // } ${texts.signup}`;\n          // minimum = timeslot.extendedProperties.shared.requiredChildren;\n\n          participantsHeader = texts.children;\n          break;\n\n        case \"admins\":\n          showing = showAdmins;\n          participantsHeader = texts.admins;\n          profiles = parentProfiles.filter(function (profile) {\n            return admins.includes(profile.user_id);\n          });\n          break;\n\n        case \"externals\":\n          participants = timeslot.extendedProperties.shared.externals;\n          showing = showExternals;\n          participantsHeader = texts.externals;\n          profiles = participants.map(function (name) {\n            return {\n              name: name,\n              image: \"/images/profiles/user_default_photo.png\"\n            };\n          });\n          break;\n\n        default:\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"participantsContainer\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"participantsHeaderContainer\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"participantsHeaderText\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }\n      }, participantsHeader), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton participantsHeaderButton\",\n        onClick: function onClick() {\n          return _this.handleShowList(type);\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: showing ? \"fas fa-chevron-up\" : \"fas fa-chevron-down\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 552,\n          columnNumber: 13\n        }\n      }))), /*#__PURE__*/React.createElement(\"ul\", {\n        style: showing ? {} : {\n          display: \"none\"\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 9\n        }\n      }, profiles.map(function (profile, index) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: index,\n          style: {\n            display: \"block\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"row\",\n          style: {\n            margin: \"1rem 0\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col-2-10\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(Avatar, {\n          className: classes.avatar,\n          src: profile.image,\n          onClick: function onClick() {\n            return _this.handleParticipantClick(type, profile);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 565,\n            columnNumber: 19\n          }\n        })), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col-7-10\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 571,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"participantsText\",\n          role: \"button\",\n          tabIndex: -42,\n          onClick: function onClick() {\n            return _this.handleParticipantClick(type, profile);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 572,\n            columnNumber: 19\n          }\n        }, profile.name)), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"col-1-10\",\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(CopyToClipboard, {\n          text: profile.phone,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"button\", {\n          className: \"transparentButton\",\n          type: \"button\",\n          onClick: function onClick() {\n            return _this.handleParticipantIconClick(profile, type);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 583,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"i\", {\n          style: {\n            color: \"rgba(0,0,0,0.6)\"\n          },\n          className: _this.handleParticipantIcon(profile, type),\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 590,\n            columnNumber: 23\n          }\n        }))))));\n      })));\n    };\n\n    _this.getUserSubscribe = function () {\n      var _this$state6 = _this.state,\n          timeslot = _this$state6.timeslot,\n          unfilteredParentProfiles = _this$state6.parentProfiles,\n          parents = _this$state6.parents;\n      var parentParticipants = timeslot.extendedProperties.shared.parents;\n      var parentProfiles = unfilteredParentProfiles.filter(function (profile) {\n        return parents.includes(profile.user_id);\n      });\n      return parentProfiles.map(function (parent) {\n        return /*#__PURE__*/React.createElement(TimeslotSubcribe, {\n          name: parent.name,\n          key: parent.user_id,\n          image: parent.image,\n          subscribed: parentParticipants.includes(parent.user_id),\n          id: parent.user_id,\n          type: \"parent\",\n          handleSubscribe: _this.handleSubscribe,\n          handleUnsubscribe: _this.handleUnsubscribe,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 617,\n            columnNumber: 7\n          }\n        });\n      });\n    };\n\n    _this.getChildrenSubscribes = function () {\n      var _this$state7 = _this.state,\n          unfilteredChildrenProfiles = _this$state7.childrenProfiles,\n          children = _this$state7.children,\n          timeslot = _this$state7.timeslot;\n      var childrenProfiles = unfilteredChildrenProfiles.filter(function (profile) {\n        return children.includes(profile.child_id);\n      });\n      var childrenParticipants = timeslot.extendedProperties.shared.children;\n      return childrenProfiles.map(function (child, index) {\n        return /*#__PURE__*/React.createElement(TimeslotSubcribe, {\n          key: index,\n          name: child.name,\n          image: child.image,\n          subscribed: childrenParticipants.includes(child.child_id),\n          id: child.child_id,\n          type: \"child\",\n          handleSubscribe: _this.handleSubscribe,\n          handleUnsubscribe: _this.handleUnsubscribe,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 641,\n            columnNumber: 7\n          }\n        });\n      });\n    };\n\n    _this.getExternalSubscribes = function () {\n      var _this$state8 = _this.state,\n          timeslot = _this$state8.timeslot,\n          externalInput = _this$state8.external;\n      var externals = timeslot.extendedProperties.shared.externals;\n      var language = _this.props.language;\n      var texts = Texts[language].timeslotScreen;\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 660,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          display: \"flex\",\n          width: \"100%\"\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 661,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"input\", {\n        style: {\n          maxWidth: \"20rem\"\n        },\n        type: \"text\",\n        name: \"external\",\n        value: externalInput,\n        className: \"expandedTimeslotInput form-control\",\n        onChange: function onChange(event) {\n          return _this.setState({\n            external: event.target.value\n          });\n        },\n        placeholder: texts.externalPlaceholder,\n        required: true,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 662,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton addExternalButton\",\n        onClick: _this.handleExternalAdd,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 672,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-plus\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 13\n        }\n      }))), externals.map(function (external) {\n        return /*#__PURE__*/React.createElement(TimeslotSubcribe, {\n          key: external,\n          name: external,\n          image: \"/images/profiles/user_default_photo.png\",\n          subscribed: true,\n          id: external,\n          type: \"external\",\n          handleUnsubscribe: _this.handleUnsubscribe,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 681,\n            columnNumber: 11\n          }\n        });\n      }));\n    };\n\n    _this.handleExternalAdd = function () {\n      var _this$state9 = _this.state,\n          external = _this$state9.external,\n          timeslot = _this$state9.timeslot;\n      var externals = timeslot.extendedProperties.shared.externals;\n      var _this$props5 = _this.props,\n          enqueueSnackbar = _this$props5.enqueueSnackbar,\n          language = _this$props5.language;\n      var texts = Texts[language].timeslotScreen;\n      var snackMessage = \"\".concat(texts.parentSubscribe1, \" \").concat(external, \" \").concat(texts.parentSubscribe2);\n\n      if (external) {\n        enqueueSnackbar(snackMessage, {\n          variant: \"info\"\n        });\n        externals.push(external);\n        timeslot.extendedProperties.shared.externals = _toConsumableArray(new Set(externals));\n\n        _this.setState({\n          external: \"\",\n          timeslot: timeslot,\n          madeChanges: true\n        });\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(TimeslotScreen, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var userId, _this$props6, history, match, groupId, pathname, timeslot, shared, parentIds, childrenIds, children, parents, members, admins, parentProfiles, childrenProfiles;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                document.addEventListener(\"message\", this.handleMessage, false);\n                userId = JSON.parse(localStorage.getItem(\"user\")).id;\n                _this$props6 = this.props, history = _this$props6.history, match = _this$props6.match;\n                groupId = match.params.groupId;\n                pathname = history.location.pathname;\n                _context.next = 7;\n                return getTimeslot(\"/api\".concat(pathname));\n\n              case 7:\n                timeslot = _context.sent;\n                shared = timeslot.extendedProperties.shared;\n                shared.parents = JSON.parse(shared.parents);\n                shared.children = JSON.parse(shared.children);\n                parentIds = _toConsumableArray(shared.parents);\n                childrenIds = _toConsumableArray(shared.children);\n                _context.next = 15;\n                return getGroupMembers(groupId);\n\n              case 15:\n                members = _context.sent;\n                admins = members.filter(function (p) {\n                  return p.admin;\n                }).map(function (m) {\n                  return m.user_id;\n                });\n\n                if (!timeslot.userCanEdit) {\n                  _context.next = 24;\n                  break;\n                }\n\n                _context.next = 20;\n                return getGroupChildren(groupId);\n\n              case 20:\n                children = _context.sent;\n                parents = members.map(function (m) {\n                  return m.user_id;\n                });\n                _context.next = 28;\n                break;\n\n              case 24:\n                _context.next = 26;\n                return getUsersChildren(userId);\n\n              case 26:\n                children = _context.sent;\n                parents = [userId];\n\n              case 28:\n                if (shared.externals) {\n                  shared.externals = JSON.parse(shared.externals);\n                } else {\n                  shared.externals = [];\n                }\n\n                childrenIds = childrenIds.concat(children);\n                parentIds = parentIds.concat(parents);\n                _context.next = 33;\n                return getParentProfiles(_toConsumableArray(new Set(parentIds)));\n\n              case 33:\n                parentProfiles = _context.sent;\n                _context.next = 36;\n                return getChildrenProfiles(_toConsumableArray(new Set(childrenIds)));\n\n              case 36:\n                childrenProfiles = _context.sent;\n                this.setState({\n                  fetchedTimeslot: true,\n                  timeslot: timeslot,\n                  parentProfiles: parentProfiles,\n                  childrenProfiles: childrenProfiles,\n                  children: children,\n                  parents: parents,\n                  admins: admins,\n                  external: \"\"\n                });\n\n              case 38:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      document.removeEventListener(\"message\", this.handleMessage, false);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var language = this.props.language;\n      var rowStyle = {\n        minHeight: \"5rem\"\n      };\n      var texts = Texts[language].timeslotScreen;\n      var now = new Date().getTime();\n      var oneDay = 86400000;\n      var _this$state10 = this.state,\n          timeslot = _this$state10.timeslot,\n          fetchedTimeslot = _this$state10.fetchedTimeslot,\n          confirmDialogIsOpen = _this$state10.confirmDialogIsOpen,\n          madeChanges = _this$state10.madeChanges,\n          confirmTrigger = _this$state10.confirmTrigger,\n          confirmData = _this$state10.confirmData;\n      return fetchedTimeslot ? /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 726,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(ConfirmDialog, {\n        title: confirmTrigger === \"phone\" ? \"\".concat(texts.phoneConfirm, \" \").concat(confirmData.name, \"?\") : texts.editConfirm,\n        isOpen: confirmDialogIsOpen,\n        handleClose: this.handleConfirmDialogClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 727,\n          columnNumber: 9\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityHeaderContainer\",\n        className: \"row no-gutters\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 736,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 737,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: function onClick() {\n          return madeChanges ? _this2.handleConfirmDialogOpen(\"back\") : _this2.handleGoBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 738,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-arrow-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 747,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-6-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 750,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 751,\n          columnNumber: 13\n        }\n      }, this.getBackNavTitle())), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 753,\n          columnNumber: 11\n        }\n      }, timeslot.userCanEdit && timeslot.extendedProperties.shared.status !== \"completed\" && /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: this.handleEdit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 756,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-pencil-alt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 761,\n          columnNumber: 19\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 765,\n          columnNumber: 11\n        }\n      }, timeslot.extendedProperties.shared.status !== \"completed\" && /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: function onClick() {\n          return madeChanges ? _this2.handleConfirmDialogOpen(\"save\") : _this2.handleGoBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 767,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-check\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 776,\n          columnNumber: 17\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityMainContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 781,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 782,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 783,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-bookmark activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 784,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 786,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 787,\n          columnNumber: 15\n        }\n      }, timeslot.summary))), timeslot.description && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 791,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 792,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-file-alt activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 793,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 795,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 796,\n          columnNumber: 17\n        }\n      }, timeslot.description))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 802,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 803,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"activityInfoImage\",\n        alt: \"map marker icon\",\n        src: Images.mapMarkerAltRegular,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 804,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 810,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 811,\n          columnNumber: 15\n        }\n      }, timeslot.location))), timeslot.extendedProperties.shared.cost && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 815,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 816,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"activityInfoImage\",\n        alt: \"euro sign icon\",\n        src: Images.euroSignRegular,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 817,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 823,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 824,\n          columnNumber: 17\n        }\n      }, timeslot.extendedProperties.shared.cost))), timeslot.extendedProperties.shared.category && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 831,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 832,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-bookmark activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 833,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 835,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 836,\n          columnNumber: 17\n        }\n      }, texts[timeslot.extendedProperties.shared.category]))), timeslot.extendedProperties.shared.link && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 843,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 844,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-link activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 845,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 847,\n          columnNumber: 15\n        }\n      }, window.isNative ? /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        role: \"button\",\n        tabIndex: -42,\n        onClick: function onClick() {\n          return _this2.handleLink(timeslot.extendedProperties.shared.link);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 849,\n          columnNumber: 19\n        }\n      }, timeslot.extendedProperties.shared.link) : /*#__PURE__*/React.createElement(\"a\", {\n        className: \"activityInfoDescription\",\n        href: timeslot.extendedProperties.shared.link,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 860,\n          columnNumber: 19\n        }\n      }, timeslot.extendedProperties.shared.link))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 870,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 871,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        className: \"activityInfoImage\",\n        alt: \"thumbtacack icon\",\n        src: Images.thumbtackRegular,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 872,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 878,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 879,\n          columnNumber: 15\n        }\n      }, texts[timeslot.extendedProperties.shared.status])))), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityMainContainer\",\n        style: {\n          marginTop: 0\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 885,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 886,\n          columnNumber: 11\n        }\n      }, timeslot.extendedProperties.shared.status === \"ongoing\" && /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 888,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 889,\n          columnNumber: 17\n        }\n      }, timeslot.userCanEdit ? texts.allUsersAvailabilities : texts.userAvailability), this.getUserSubscribe(), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 895,\n          columnNumber: 17\n        }\n      }, timeslot.userCanEdit ? texts.allChildrenAvailabilities : texts.childrenAvailability), this.getChildrenSubscribes(), timeslot.userCanEdit && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 902,\n          columnNumber: 19\n        }\n      }, texts.externalAvailabilities), timeslot.userCanEdit && this.getExternalSubscribes()), this.renderParticipants(\"parents\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 911,\n          columnNumber: 11\n        }\n      }, this.renderParticipants(\"children\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 914,\n          columnNumber: 11\n        }\n      }, this.renderParticipants(\"externals\")), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 917,\n          columnNumber: 11\n        }\n      }, this.renderParticipants(\"admins\"))), timeslot.extendedProperties.shared.status !== \"completed\" && new Date(timeslot.start.dateTime).getTime() - now < oneDay && /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityMainContainer\",\n        style: {\n          margin: 0\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 923,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 924,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        className: \"emergencyButton\",\n        type: \"button\",\n        onClick: this.handleEmergency,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 925,\n          columnNumber: 17\n        }\n      }, texts.emergency)))) : /*#__PURE__*/React.createElement(LoadingSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 937,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return TimeslotScreen;\n}(React.Component);\n\nexport default withStyles(styles)(withSnackbar(withLanguage(TimeslotScreen)));\nTimeslotScreen.propTypes = {\n  language: PropTypes.string,\n  history: PropTypes.object,\n  enqueueSnackbar: PropTypes.func,\n  classes: PropTypes.object,\n  match: PropTypes.object\n};","map":{"version":3,"sources":["C:/Users/nucle/Documents/GitHub/Families_Share-platform/client/src/components/TimeslotScreen.js"],"names":["React","axios","moment","withSnackbar","Avatar","withStyles","PropTypes","path","CopyToClipboard","Texts","withLanguage","ConfirmDialog","LoadingSpinner","TimeslotSubcribe","Images","Log","styles","avatar","width","height","getTimeslot","pathname","get","then","response","data","catch","error","start","dateTime","end","extendedProperties","shared","parents","children","getUsersChildren","userId","map","child","child_id","getGroupChildren","groupId","getGroupMembers","filter","m","group_accepted","user_accepted","getChildrenProfiles","ids","params","image","name","given_name","family_name","getParentProfiles","searchBy","parent","user_id","phone","id","TimeslotScreen","state","fetchedTimeslot","madeChanges","confirmDialogIsOpen","confirmTrigger","confirmData","showParents","showChildren","showAdmins","showExternals","parentProfiles","childrenProfiles","timeslot","adminChanges","handleGoBack","history","props","length","replace","goBack","handleMessage","event","JSON","parse","action","handleConfirmDialogOpen","handleLink","link","message","value","window","isNative","ReactNativeWebView","postMessage","stringify","handleEdit","location","route","push","handleEmergency","handleParticipantIcon","profile","type","undefined","handleParticipantIconClick","enqueueSnackbar","language","texts","timeslotScreen","setState","copy","variant","handleSave","externals","patch","info","handleConfirmDialogClose","choice","handleSubscribe","localStorage","getItem","snackMessage","status","userCanEdit","parentName","find","parentSubscribe1","parentSubscribe2","userSubscribe","childName","childSubscribe1","childSubscribe2","cannotEdit","handleUnsubscribe","subId","parentUnsubscribe1","parentUnsubscribe2","userUnsubscribe","childUnsubscribe1","childUnsubscribe2","e","getBackNavTitle","format","handleShowList","handleParticipantClick","renderParticipants","classes","admins","participants","profiles","showing","participantsHeader","includes","volunteers","display","index","margin","color","getUserSubscribe","unfilteredParentProfiles","parentParticipants","getChildrenSubscribes","unfilteredChildrenProfiles","childrenParticipants","getExternalSubscribes","externalInput","external","maxWidth","target","externalPlaceholder","handleExternalAdd","Set","document","addEventListener","match","parentIds","childrenIds","members","p","admin","concat","removeEventListener","rowStyle","minHeight","now","Date","getTime","oneDay","phoneConfirm","editConfirm","summary","description","mapMarkerAltRegular","cost","euroSignRegular","category","thumbtackRegular","marginTop","allUsersAvailabilities","userAvailability","allChildrenAvailabilities","childrenAvailability","externalAvailabilities","emergency","Component","propTypes","string","object","func"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport { withSnackbar } from \"notistack\";\r\nimport Avatar from \"@material-ui/core/Avatar\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport PropTypes from \"prop-types\";\r\nimport * as path from \"lodash.get\";\r\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\r\nimport Texts from \"../Constants/Texts\";\r\nimport withLanguage from \"./LanguageContext\";\r\nimport ConfirmDialog from \"./ConfirmDialog\";\r\nimport LoadingSpinner from \"./LoadingSpinner\";\r\nimport TimeslotSubcribe from \"./TimeslotSubcribe\";\r\nimport Images from \"../Constants/Images\";\r\nimport Log from \"./Log\";\r\n\r\nconst styles = () => ({\r\n  avatar: {\r\n    width: \"3rem\",\r\n    height: \"3rem\"\r\n  }\r\n});\r\n\r\nconst getTimeslot = pathname => {\r\n  return axios\r\n    .get(pathname)\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return {\r\n        start: {\r\n          dateTime: \"\"\r\n        },\r\n        end: {\r\n          dateTime: \"\"\r\n        },\r\n        extendedProperties: {\r\n          shared: {\r\n            parents: \"[]\",\r\n            children: \"[]\"\r\n          }\r\n        }\r\n      };\r\n    });\r\n};\r\n\r\nconst getUsersChildren = userId => {\r\n  return axios\r\n    .get(`/api/users/${userId}/children`)\r\n    .then(response => {\r\n      return response.data.map(child => child.child_id);\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getGroupChildren = groupId => {\r\n  return axios\r\n    .get(`/api/groups/${groupId}/children`)\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getGroupMembers = groupId => {\r\n  return axios\r\n    .get(`/api/groups/${groupId}/members`)\r\n    .then(response => {\r\n      return response.data.filter(m => m.group_accepted && m.user_accepted);\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getChildrenProfiles = ids => {\r\n  return axios\r\n    .get(\"/api/children\", {\r\n      params: {\r\n        ids\r\n      }\r\n    })\r\n    .then(response => {\r\n      return response.data.map(child => {\r\n        return {\r\n          child_id: child.child_id,\r\n          image: path(child, [\"image\", \"path\"]),\r\n          name: `${child.given_name} ${child.family_name}`,\r\n          given_name: child.given_name\r\n        };\r\n      });\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getParentProfiles = ids => {\r\n  return axios\r\n    .get(\"/api/profiles\", {\r\n      params: {\r\n        ids,\r\n        searchBy: \"ids\"\r\n      }\r\n    })\r\n    .then(response => {\r\n      return response.data.map(parent => {\r\n        return {\r\n          user_id: parent.user_id,\r\n          image: path(parent, [\"image\", \"path\"]),\r\n          name: `${parent.given_name} ${parent.family_name}`,\r\n          phone: parent.phone,\r\n          given_name: parent.given_name,\r\n          family_name: parent.family_name\r\n        };\r\n      });\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [\r\n        {\r\n          image: \"\",\r\n          name: \"\",\r\n          id: \"\"\r\n        }\r\n      ];\r\n    });\r\n};\r\n\r\nclass TimeslotScreen extends React.Component {\r\n  state = {\r\n    fetchedTimeslot: false,\r\n    madeChanges: false,\r\n    confirmDialogIsOpen: false,\r\n    confirmTrigger: \"\",\r\n    confirmData: {},\r\n    showParents: false,\r\n    showChildren: false,\r\n    showAdmins: false,\r\n    showExternals: false,\r\n    children: [],\r\n    parentProfiles: [],\r\n    childrenProfiles: [],\r\n    timeslot: {\r\n      extendedProperties: {\r\n        shared: {\r\n          parents: [],\r\n          children: []\r\n        }\r\n      }\r\n    },\r\n    adminChanges: {}\r\n  };\r\n\r\n  async componentDidMount() {\r\n    document.addEventListener(\"message\", this.handleMessage, false);\r\n    const userId = JSON.parse(localStorage.getItem(\"user\")).id;\r\n    const { history, match } = this.props;\r\n    const { groupId } = match.params;\r\n    const { pathname } = history.location;\r\n    const timeslot = await getTimeslot(`/api${pathname}`);\r\n    const { shared } = timeslot.extendedProperties;\r\n    shared.parents = JSON.parse(shared.parents);\r\n    shared.children = JSON.parse(shared.children);\r\n    let parentIds = [...shared.parents];\r\n    let childrenIds = [...shared.children];\r\n    let children;\r\n    let parents;\r\n    const members = await getGroupMembers(groupId);\r\n    const admins = members.filter(p => p.admin).map(m => m.user_id);\r\n    if (timeslot.userCanEdit) {\r\n      children = await getGroupChildren(groupId);\r\n      parents = members.map(m => m.user_id);\r\n    } else {\r\n      children = await getUsersChildren(userId);\r\n      parents = [userId];\r\n    }\r\n    if (shared.externals) {\r\n      shared.externals = JSON.parse(shared.externals);\r\n    } else {\r\n      shared.externals = [];\r\n    }\r\n    childrenIds = childrenIds.concat(children);\r\n    parentIds = parentIds.concat(parents);\r\n\r\n    const parentProfiles = await getParentProfiles([...new Set(parentIds)]);\r\n    const childrenProfiles = await getChildrenProfiles([\r\n      ...new Set(childrenIds)\r\n    ]);\r\n    this.setState({\r\n      fetchedTimeslot: true,\r\n      timeslot,\r\n      parentProfiles,\r\n      childrenProfiles,\r\n      children,\r\n      parents,\r\n      admins,\r\n      external: \"\"\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener(\"message\", this.handleMessage, false);\r\n  }\r\n\r\n  handleGoBack = () => {\r\n    const { history } = this.props;\r\n    if (history.length === 1) {\r\n      history.replace(\"/myfamiliesshare\");\r\n    } else {\r\n      history.goBack();\r\n    }\r\n  };\r\n\r\n  handleMessage = event => {\r\n    const { madeChanges } = this.state;\r\n    const data = JSON.parse(event.data);\r\n    if (data.action === \"confirmGoBack\") {\r\n      if (madeChanges) {\r\n        this.handleConfirmDialogOpen(\"back\");\r\n      } else {\r\n        this.handleGoBack();\r\n      }\r\n    }\r\n  };\r\n\r\n  handleLink = link => {\r\n    const message = {\r\n      action: \"link\",\r\n      value: link\r\n    };\r\n    if (window.isNative) {\r\n      window.ReactNativeWebView.postMessage(JSON.stringify(message));\r\n    }\r\n  };\r\n\r\n  handleEdit = () => {\r\n    const { history } = this.props;\r\n    const { pathname } = history.location;\r\n    const route = `${pathname}/edit`;\r\n    history.push(route);\r\n  };\r\n\r\n  handleEmergency = () => {\r\n    const { history } = this.props;\r\n    const { pathname } = history.location;\r\n    const { timeslot } = this.state;\r\n    history.push({\r\n      pathname: `${pathname}/emergency`,\r\n      state: {\r\n        timeslot\r\n      }\r\n    });\r\n  };\r\n\r\n  handleParticipantIcon = (profile, type) => {\r\n    if (\r\n      (type === \"parents\" || type === \"admins\") &&\r\n      profile.phone !== undefined\r\n    ) {\r\n      return \"fas fa-phone emergencyNumber\";\r\n    }\r\n    if (type === \"children\") {\r\n      return \"fas fa-info-circle emergencyNumber\";\r\n    }\r\n    return \"\";\r\n  };\r\n\r\n  handleParticipantIconClick = (profile, type) => {\r\n    const { history, enqueueSnackbar, language } = this.props;\r\n    const texts = Texts[language].timeslotScreen;\r\n    if (type === \"children\") {\r\n      history.push(`/profiles/groupmember/children/${profile.child_id}`);\r\n    } else if (type !== \"externals\" && profile.phone !== undefined) {\r\n      if (window.isNative) {\r\n        this.setState({\r\n          confirmDialogIsOpen: true,\r\n          confirmTrigger: \"phone\",\r\n          confirmData: profile\r\n        });\r\n      } else {\r\n        enqueueSnackbar(texts.copy, {\r\n          variant: \"info\"\r\n        });\r\n      }\r\n    }\r\n  };\r\n\r\n  handleSave = () => {\r\n    const { history } = this.props;\r\n    const { pathname } = history.location;\r\n    const { timeslot, adminChanges } = JSON.parse(JSON.stringify(this.state));\r\n    timeslot.adminChanges = adminChanges;\r\n    timeslot.extendedProperties.shared.children = JSON.stringify(\r\n      timeslot.extendedProperties.shared.children\r\n    );\r\n    timeslot.extendedProperties.shared.parents = JSON.stringify(\r\n      timeslot.extendedProperties.shared.parents\r\n    );\r\n    timeslot.extendedProperties.shared.externals = JSON.stringify(\r\n      timeslot.extendedProperties.shared.externals\r\n    );\r\n\r\n    axios\r\n      .patch(`/api${pathname}`, {\r\n        ...timeslot\r\n      })\r\n      .then(response => {\r\n        Log.info(response);\r\n        this.handleGoBack();\r\n      })\r\n      .catch(error => {\r\n        Log.error(error);\r\n      });\r\n  };\r\n\r\n  handleConfirmDialogClose = choice => {\r\n    const { confirmTrigger, confirmData } = this.state;\r\n    if (choice === \"agree\") {\r\n      if (confirmTrigger === \"phone\") {\r\n        window.ReactNativeWebView.postMessage(\r\n          JSON.stringify({\r\n            action: \"phoneCall\",\r\n            value: confirmData.phone\r\n          })\r\n        );\r\n      } else {\r\n        this.handleSave();\r\n      }\r\n    } else if (confirmTrigger === \"back\") {\r\n      this.handleGoBack();\r\n    }\r\n    this.setState({ confirmDialogIsOpen: false, confirmTrigger: \"\" });\r\n  };\r\n\r\n  handleConfirmDialogOpen = confirmTrigger => {\r\n    this.setState({ confirmDialogIsOpen: true, confirmTrigger });\r\n  };\r\n\r\n  handleSubscribe = (id, type) => {\r\n    const userId = JSON.parse(localStorage.getItem(\"user\")).id;\r\n    const { language, enqueueSnackbar } = this.props;\r\n    const {\r\n      timeslot,\r\n      childrenProfiles,\r\n      parentProfiles,\r\n      adminChanges\r\n    } = this.state;\r\n    let snackMessage;\r\n    const texts = Texts[language].timeslotScreen;\r\n    if (timeslot.extendedProperties.shared.status !== \"completed\") {\r\n      if (type === \"parent\") {\r\n        timeslot.extendedProperties.shared.parents.push(id);\r\n        if (timeslot.userCanEdit && userId !== id) {\r\n          if (adminChanges[id]) {\r\n            adminChanges[id] += 2;\r\n          } else {\r\n            adminChanges[id] = 2;\r\n          }\r\n          const parentName = parentProfiles.find(\r\n            profile => profile.user_id === id\r\n          ).given_name;\r\n          snackMessage = `${texts.parentSubscribe1} ${parentName} ${texts.parentSubscribe2}`;\r\n        } else {\r\n          snackMessage = texts.userSubscribe;\r\n        }\r\n      } else {\r\n        const childName = childrenProfiles.find(\r\n          profile => profile.child_id === id\r\n        ).given_name;\r\n        timeslot.extendedProperties.shared.children.push(id);\r\n        snackMessage = `${texts.childSubscribe1} ${childName} ${texts.childSubscribe2}`;\r\n      }\r\n      this.setState({ timeslot, madeChanges: true });\r\n    } else {\r\n      snackMessage = texts.cannotEdit;\r\n    }\r\n    enqueueSnackbar(snackMessage, {\r\n      variant: \"info\"\r\n    });\r\n  };\r\n\r\n  handleUnsubscribe = (id, type) => {\r\n    const userId = JSON.parse(localStorage.getItem(\"user\")).id;\r\n    const { language, enqueueSnackbar } = this.props;\r\n    const {\r\n      timeslot,\r\n      childrenProfiles,\r\n      parentProfiles,\r\n      adminChanges\r\n    } = this.state;\r\n    const texts = Texts[language].timeslotScreen;\r\n    let snackMessage;\r\n    if (timeslot.extendedProperties.shared.status !== \"completed\") {\r\n      if (type === \"parent\") {\r\n        timeslot.extendedProperties.shared.parents = timeslot.extendedProperties.shared.parents.filter(\r\n          subId => subId !== id\r\n        );\r\n        if (timeslot.userCanEdit && userId !== id) {\r\n          if (adminChanges[id]) {\r\n            adminChanges[id] -= 2;\r\n          } else {\r\n            adminChanges[id] = -2;\r\n          }\r\n          const parentName = parentProfiles.find(\r\n            profile => profile.user_id === id\r\n          ).given_name;\r\n          snackMessage = `${texts.parentUnsubscribe1} ${parentName} ${texts.parentUnsubscribe2}`;\r\n        } else {\r\n          snackMessage = texts.userUnsubscribe;\r\n        }\r\n      } else if (type === \"child\") {\r\n        const childName = childrenProfiles.find(\r\n          profile => profile.child_id === id\r\n        ).given_name;\r\n        timeslot.extendedProperties.shared.children = timeslot.extendedProperties.shared.children.filter(\r\n          subId => subId !== id\r\n        );\r\n        snackMessage = `${texts.childUnsubscribe1} ${childName} ${texts.childUnsubscribe2}`;\r\n      } else {\r\n        timeslot.extendedProperties.shared.externals = timeslot.extendedProperties.shared.externals.filter(\r\n          e => e !== id\r\n        );\r\n        snackMessage = `${texts.parentUnsubscribe1} ${id} ${texts.parentUnsubscribe2}`;\r\n      }\r\n      this.setState({ timeslot, madeChanges: true });\r\n    } else {\r\n      snackMessage = texts.cannotEdit;\r\n    }\r\n    enqueueSnackbar(snackMessage, {\r\n      variant: \"info\"\r\n    });\r\n  };\r\n\r\n  getBackNavTitle = () => {\r\n    const { timeslot } = this.state;\r\n    const { start, end } = timeslot;\r\n    return `${moment(start.dateTime).format(\"DD MMM\")} ${moment(\r\n      start.dateTime\r\n    ).format(\"HH:mm\")}-${moment(end.dateTime).format(\"HH:mm\")}`;\r\n  };\r\n\r\n  handleShowList = type => {\r\n    const { showParents, showAdmins, showChildren, showExternals } = this.state;\r\n    switch (type) {\r\n      case \"parents\":\r\n        this.setState({ showParents: !showParents });\r\n        break;\r\n      case \"children\":\r\n        this.setState({ showChildren: !showChildren });\r\n        break;\r\n      case \"admins\":\r\n        this.setState({ showAdmins: !showAdmins });\r\n        break;\r\n      case \"externals\":\r\n        this.setState({ showExternals: !showExternals });\r\n        break;\r\n      default:\r\n    }\r\n  };\r\n\r\n  handleParticipantClick = (type, profile) => {\r\n    const { history } = this.props;\r\n    if (type === \"children\") {\r\n      history.push(`/profiles/groupmember/children/${profile.child_id}`);\r\n    } else if (type !== \"externals\") {\r\n      history.push(`/profiles/${profile.user_id}/info`);\r\n    }\r\n  };\r\n\r\n  renderParticipants = type => {\r\n    const { language, classes } = this.props;\r\n    const {\r\n      timeslot,\r\n      parentProfiles,\r\n      showParents,\r\n      childrenProfiles,\r\n      showChildren,\r\n      showAdmins,\r\n      showExternals,\r\n      admins\r\n    } = this.state;\r\n    const texts = Texts[language].timeslotScreen;\r\n    let participants;\r\n    let profiles;\r\n    let showing;\r\n    let participantsHeader;\r\n    // let minimum;\r\n    switch (type) {\r\n      case \"parents\":\r\n        participants = timeslot.extendedProperties.shared.parents;\r\n        profiles = parentProfiles.filter(profile =>\r\n          participants.includes(profile.user_id)\r\n        );\r\n        showing = showParents;\r\n        // participantsHeader = `${participants.length} ${\r\n        //   participants.length === 1 ? texts.volunteer : texts.volunteers\r\n        // } ${texts.signup}`;\r\n        // minimum = timeslot.extendedProperties.shared.requiredParents;\r\n        participantsHeader = texts.volunteers;\r\n        break;\r\n      case \"children\":\r\n        participants = timeslot.extendedProperties.shared.children;\r\n        profiles = childrenProfiles.filter(profile =>\r\n          participants.includes(profile.child_id)\r\n        );\r\n        showing = showChildren;\r\n        // participantsHeader = `${participants.length} ${\r\n        //   participants.length === 1 ? texts.child : texts.children\r\n        // } ${texts.signup}`;\r\n        // minimum = timeslot.extendedProperties.shared.requiredChildren;\r\n        participantsHeader = texts.children;\r\n        break;\r\n      case \"admins\":\r\n        showing = showAdmins;\r\n        participantsHeader = texts.admins;\r\n        profiles = parentProfiles.filter(profile =>\r\n          admins.includes(profile.user_id)\r\n        );\r\n        break;\r\n      case \"externals\":\r\n        participants = timeslot.extendedProperties.shared.externals;\r\n        showing = showExternals;\r\n        participantsHeader = texts.externals;\r\n        profiles = participants.map(name => ({\r\n          name,\r\n          image: \"/images/profiles/user_default_photo.png\"\r\n        }));\r\n        break;\r\n      default:\r\n    }\r\n    return (\r\n      <div className=\"participantsContainer\">\r\n        <div className=\"participantsHeaderContainer\">\r\n          <div className=\"participantsHeaderText\">{participantsHeader}</div>\r\n          <button\r\n            type=\"button\"\r\n            className=\"transparentButton participantsHeaderButton\"\r\n            onClick={() => this.handleShowList(type)}\r\n          >\r\n            <i\r\n              className={showing ? \"fas fa-chevron-up\" : \"fas fa-chevron-down\"}\r\n            />\r\n          </button>\r\n        </div>\r\n        <ul style={showing ? {} : { display: \"none\" }}>\r\n          {/* <div className=\"participantsMinimum\">\r\n            {`${texts.minimum} ${minimum}`}\r\n          </div> */}\r\n          {profiles.map((profile, index) => (\r\n            <li key={index} style={{ display: \"block\" }}>\r\n              <div className=\"row\" style={{ margin: \"1rem 0\" }}>\r\n                <div className=\"col-2-10\">\r\n                  <Avatar\r\n                    className={classes.avatar}\r\n                    src={profile.image}\r\n                    onClick={() => this.handleParticipantClick(type, profile)}\r\n                  />\r\n                </div>\r\n                <div className=\"col-7-10\">\r\n                  <div\r\n                    className=\"participantsText\"\r\n                    role=\"button\"\r\n                    tabIndex={-42}\r\n                    onClick={() => this.handleParticipantClick(type, profile)}\r\n                  >\r\n                    {profile.name}\r\n                  </div>\r\n                </div>\r\n                <div className=\"col-1-10\">\r\n                  <CopyToClipboard text={profile.phone}>\r\n                    <button\r\n                      className=\"transparentButton\"\r\n                      type=\"button\"\r\n                      onClick={() =>\r\n                        this.handleParticipantIconClick(profile, type)\r\n                      }\r\n                    >\r\n                      <i\r\n                        style={{ color: \"rgba(0,0,0,0.6)\" }}\r\n                        className={this.handleParticipantIcon(profile, type)}\r\n                      />\r\n                    </button>\r\n                  </CopyToClipboard>\r\n                </div>\r\n              </div>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  getUserSubscribe = () => {\r\n    const {\r\n      timeslot,\r\n      parentProfiles: unfilteredParentProfiles,\r\n      parents\r\n    } = this.state;\r\n\r\n    const parentParticipants = timeslot.extendedProperties.shared.parents;\r\n    const parentProfiles = unfilteredParentProfiles.filter(profile =>\r\n      parents.includes(profile.user_id)\r\n    );\r\n    return parentProfiles.map(parent => (\r\n      <TimeslotSubcribe\r\n        name={parent.name}\r\n        key={parent.user_id}\r\n        image={parent.image}\r\n        subscribed={parentParticipants.includes(parent.user_id)}\r\n        id={parent.user_id}\r\n        type=\"parent\"\r\n        handleSubscribe={this.handleSubscribe}\r\n        handleUnsubscribe={this.handleUnsubscribe}\r\n      />\r\n    ));\r\n  };\r\n\r\n  getChildrenSubscribes = () => {\r\n    const {\r\n      childrenProfiles: unfilteredChildrenProfiles,\r\n      children,\r\n      timeslot\r\n    } = this.state;\r\n    const childrenProfiles = unfilteredChildrenProfiles.filter(profile =>\r\n      children.includes(profile.child_id)\r\n    );\r\n    const childrenParticipants = timeslot.extendedProperties.shared.children;\r\n    return childrenProfiles.map((child, index) => (\r\n      <TimeslotSubcribe\r\n        key={index}\r\n        name={child.name}\r\n        image={child.image}\r\n        subscribed={childrenParticipants.includes(child.child_id)}\r\n        id={child.child_id}\r\n        type=\"child\"\r\n        handleSubscribe={this.handleSubscribe}\r\n        handleUnsubscribe={this.handleUnsubscribe}\r\n      />\r\n    ));\r\n  };\r\n\r\n  getExternalSubscribes = () => {\r\n    const { timeslot, external: externalInput } = this.state;\r\n    const { externals } = timeslot.extendedProperties.shared;\r\n    const { language } = this.props;\r\n    const texts = Texts[language].timeslotScreen;\r\n    return (\r\n      <React.Fragment>\r\n        <div style={{ display: \"flex\", width: \"100%\" }}>\r\n          <input\r\n            style={{ maxWidth: \"20rem\" }}\r\n            type=\"text\"\r\n            name=\"external\"\r\n            value={externalInput}\r\n            className=\"expandedTimeslotInput form-control\"\r\n            onChange={event => this.setState({ external: event.target.value })}\r\n            placeholder={texts.externalPlaceholder}\r\n            required\r\n          />\r\n          <button\r\n            type=\"button\"\r\n            className=\"transparentButton addExternalButton\"\r\n            onClick={this.handleExternalAdd}\r\n          >\r\n            <i className=\"fas fa-plus\" />\r\n          </button>\r\n        </div>\r\n        {externals.map(external => (\r\n          <TimeslotSubcribe\r\n            key={external}\r\n            name={external}\r\n            image=\"/images/profiles/user_default_photo.png\"\r\n            subscribed\r\n            id={external}\r\n            type=\"external\"\r\n            handleUnsubscribe={this.handleUnsubscribe}\r\n          />\r\n        ))}\r\n      </React.Fragment>\r\n    );\r\n  };\r\n\r\n  handleExternalAdd = () => {\r\n    const { external, timeslot } = this.state;\r\n    const { externals } = timeslot.extendedProperties.shared;\r\n    const { enqueueSnackbar, language } = this.props;\r\n    const texts = Texts[language].timeslotScreen;\r\n    const snackMessage = `${texts.parentSubscribe1} ${external} ${texts.parentSubscribe2}`;\r\n    if (external) {\r\n      enqueueSnackbar(snackMessage, {\r\n        variant: \"info\"\r\n      });\r\n      externals.push(external);\r\n      timeslot.extendedProperties.shared.externals = [...new Set(externals)];\r\n      this.setState({ external: \"\", timeslot, madeChanges: true });\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { language } = this.props;\r\n    const rowStyle = { minHeight: \"5rem\" };\r\n    const texts = Texts[language].timeslotScreen;\r\n    const now = new Date().getTime();\r\n    const oneDay = 86400000;\r\n    const {\r\n      timeslot,\r\n      fetchedTimeslot,\r\n      confirmDialogIsOpen,\r\n      madeChanges,\r\n      confirmTrigger,\r\n      confirmData\r\n    } = this.state;\r\n    return fetchedTimeslot ? (\r\n      <React.Fragment>\r\n        <ConfirmDialog\r\n          title={\r\n            confirmTrigger === \"phone\"\r\n              ? `${texts.phoneConfirm} ${confirmData.name}?`\r\n              : texts.editConfirm\r\n          }\r\n          isOpen={confirmDialogIsOpen}\r\n          handleClose={this.handleConfirmDialogClose}\r\n        />\r\n        <div id=\"activityHeaderContainer\" className=\"row no-gutters\">\r\n          <div className=\"col-2-10\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"transparentButton center\"\r\n              onClick={() =>\r\n                madeChanges\r\n                  ? this.handleConfirmDialogOpen(\"back\")\r\n                  : this.handleGoBack()\r\n              }\r\n            >\r\n              <i className=\"fas fa-arrow-left\" />\r\n            </button>\r\n          </div>\r\n          <div className=\"col-6-10\">\r\n            <h1 className=\"center\">{this.getBackNavTitle()}</h1>\r\n          </div>\r\n          <div className=\"col-1-10\">\r\n            {timeslot.userCanEdit &&\r\n              timeslot.extendedProperties.shared.status !== \"completed\" && (\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"transparentButton center\"\r\n                  onClick={this.handleEdit}\r\n                >\r\n                  <i className=\"fas fa-pencil-alt\" />\r\n                </button>\r\n              )}\r\n          </div>\r\n          <div className=\"col-1-10\">\r\n            {timeslot.extendedProperties.shared.status !== \"completed\" && (\r\n              <button\r\n                type=\"button\"\r\n                className=\"transparentButton center\"\r\n                onClick={() =>\r\n                  madeChanges\r\n                    ? this.handleConfirmDialogOpen(\"save\")\r\n                    : this.handleGoBack()\r\n                }\r\n              >\r\n                <i className=\"fas fa-check\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n        <div id=\"activityMainContainer\">\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            <div className=\"col-2-10\">\r\n              <i className=\"far fa-bookmark activityInfoIcon\" />\r\n            </div>\r\n            <div className=\"col-8-10\">\r\n              <div className=\"activityInfoDescription\">{timeslot.summary}</div>\r\n            </div>\r\n          </div>\r\n          {timeslot.description && (\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"col-2-10\">\r\n                <i className=\"far fa-file-alt activityInfoIcon\" />\r\n              </div>\r\n              <div className=\"col-8-10\">\r\n                <div className=\"activityInfoDescription\">\r\n                  {timeslot.description}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            <div className=\"col-2-10\">\r\n              <img\r\n                className=\"activityInfoImage\"\r\n                alt=\"map marker icon\"\r\n                src={Images.mapMarkerAltRegular}\r\n              />\r\n            </div>\r\n            <div className=\"col-8-10\">\r\n              <div className=\"activityInfoDescription\">{timeslot.location}</div>\r\n            </div>\r\n          </div>\r\n          {timeslot.extendedProperties.shared.cost && (\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"col-2-10\">\r\n                <img\r\n                  className=\"activityInfoImage\"\r\n                  alt=\"euro sign icon\"\r\n                  src={Images.euroSignRegular}\r\n                />\r\n              </div>\r\n              <div className=\"col-8-10\">\r\n                <div className=\"activityInfoDescription\">\r\n                  {timeslot.extendedProperties.shared.cost}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {timeslot.extendedProperties.shared.category && (\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"col-2-10\">\r\n                <i className=\"fas fa-bookmark activityInfoIcon\" />\r\n              </div>\r\n              <div className=\"col-8-10\">\r\n                <div className=\"activityInfoDescription\">\r\n                  {texts[timeslot.extendedProperties.shared.category]}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          {timeslot.extendedProperties.shared.link && (\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"col-2-10\">\r\n                <i className=\"fas fa-link activityInfoIcon\" />\r\n              </div>\r\n              <div className=\"col-8-10\">\r\n                {window.isNative ? (\r\n                  <div\r\n                    className=\"activityInfoDescription\"\r\n                    role=\"button\"\r\n                    tabIndex={-42}\r\n                    onClick={() =>\r\n                      this.handleLink(timeslot.extendedProperties.shared.link)\r\n                    }\r\n                  >\r\n                    {timeslot.extendedProperties.shared.link}\r\n                  </div>\r\n                ) : (\r\n                  <a\r\n                    className=\"activityInfoDescription\"\r\n                    href={timeslot.extendedProperties.shared.link}\r\n                  >\r\n                    {timeslot.extendedProperties.shared.link}\r\n                  </a>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            <div className=\"col-2-10\">\r\n              <img\r\n                className=\"activityInfoImage\"\r\n                alt=\"thumbtacack icon\"\r\n                src={Images.thumbtackRegular}\r\n              />\r\n            </div>\r\n            <div className=\"col-8-10\">\r\n              <div className=\"activityInfoDescription\">\r\n                {texts[timeslot.extendedProperties.shared.status]}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div id=\"activityMainContainer\" style={{ marginTop: 0 }}>\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            {timeslot.extendedProperties.shared.status === \"ongoing\" && (\r\n              <React.Fragment>\r\n                <div className=\"activityInfoHeader\">\r\n                  {timeslot.userCanEdit\r\n                    ? texts.allUsersAvailabilities\r\n                    : texts.userAvailability}\r\n                </div>\r\n                {this.getUserSubscribe()}\r\n                <div className=\"activityInfoHeader\">\r\n                  {timeslot.userCanEdit\r\n                    ? texts.allChildrenAvailabilities\r\n                    : texts.childrenAvailability}\r\n                </div>\r\n                {this.getChildrenSubscribes()}\r\n                {timeslot.userCanEdit && (\r\n                  <div className=\"activityInfoHeader\">\r\n                    {texts.externalAvailabilities}\r\n                  </div>\r\n                )}\r\n                {timeslot.userCanEdit && this.getExternalSubscribes()}\r\n              </React.Fragment>\r\n            )}\r\n            {this.renderParticipants(\"parents\")}\r\n          </div>\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            {this.renderParticipants(\"children\")}\r\n          </div>\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            {this.renderParticipants(\"externals\")}\r\n          </div>\r\n          <div className=\"row no-gutters\" style={rowStyle}>\r\n            {this.renderParticipants(\"admins\")}\r\n          </div>\r\n        </div>\r\n        {timeslot.extendedProperties.shared.status !== \"completed\" &&\r\n          new Date(timeslot.start.dateTime).getTime() - now < oneDay && (\r\n            <div id=\"activityMainContainer\" style={{ margin: 0 }}>\r\n              <div className=\"row no-gutters\" style={rowStyle}>\r\n                <button\r\n                  className=\"emergencyButton\"\r\n                  type=\"button\"\r\n                  onClick={this.handleEmergency}\r\n                >\r\n                  {texts.emergency}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          )}\r\n      </React.Fragment>\r\n    ) : (\r\n      <LoadingSpinner />\r\n    );\r\n  }\r\n}\r\n\r\nexport default withStyles(styles)(withSnackbar(withLanguage(TimeslotScreen)));\r\n\r\nTimeslotScreen.propTypes = {\r\n  language: PropTypes.string,\r\n  history: PropTypes.object,\r\n  enqueueSnackbar: PropTypes.func,\r\n  classes: PropTypes.object,\r\n  match: PropTypes.object\r\n};\r\n"]},"metadata":{},"sourceType":"module"}