{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _toConsumableArray from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/toConsumableArray\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _createSuper from \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"C:\\\\Users\\\\nucle\\\\Documents\\\\GitHub\\\\Green-Wizards\\\\client\\\\src\\\\components\\\\ActivityScreen.js\";\nimport React from \"react\";\nimport axios from \"axios\";\nimport moment from \"moment\";\nimport PropTypes from \"prop-types\";\nimport Fab from \"@material-ui/core/Fab\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport * as path from \"lodash.get\";\nimport { withSnackbar } from \"notistack\";\nimport Texts from \"../Constants/Texts\";\nimport withLanguage from \"./LanguageContext\";\nimport TimeslotsList from \"./TimeslotsList\";\nimport ConfirmDialog from \"./ConfirmDialog\";\nimport OptionsModal from \"./OptionsModal\";\nimport LoadingSpinner from \"./LoadingSpinner\";\nimport Images from \"../Constants/Images\";\nimport Log from \"./Log\";\nimport Avatar from \"./Avatar\";\nvar styles = {\n  add: {\n    position: \"fixed\",\n    bottom: \"3rem\",\n    right: \"5%\",\n    height: \"5rem\",\n    width: \"5rem\",\n    borderRadius: \"50%\",\n    border: \"solid 0.5px #999\",\n    backgroundColor: \"#ff6f00\",\n    zIndex: 100,\n    fontSize: \"2rem\"\n  },\n  avatar: {\n    width: \"3rem!important\",\n    height: \"3rem!important\"\n  }\n};\n\nvar getActivityTimeslots = function getActivityTimeslots(activityId, groupId) {\n  return axios.get(\"/api/groups/\".concat(groupId, \"/activities/\").concat(activityId, \"/timeslots\")).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getActivity = function getActivity(activityId, groupId) {\n  return axios.get(\"/api/groups/\".concat(groupId, \"/activities/\").concat(activityId)).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return {\n      name: \"\",\n      description: \"\",\n      color: \"#ffffff\",\n      group_name: \"\",\n      location: \"\",\n      dates: [],\n      repetition_type: \"\"\n    };\n  });\n};\n\nvar getGroupMembers = function getGroupMembers(groupId) {\n  return axios.get(\"/api/groups/\".concat(groupId, \"/members\")).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getActivityChildren = function getActivityChildren(ids) {\n  return axios.get(\"/api/children\", {\n    params: {\n      ids: ids,\n      searchBy: \"ids\"\n    }\n  }).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar getActivityParents = function getActivityParents(ids) {\n  return axios.get(\"/api/profiles\", {\n    params: {\n      ids: ids,\n      searchBy: \"ids\"\n    }\n  }).then(function (response) {\n    return response.data;\n  }).catch(function (error) {\n    Log.error(error);\n    return [];\n  });\n};\n\nvar ActivityScreen = /*#__PURE__*/function (_React$Component) {\n  _inherits(ActivityScreen, _React$Component);\n\n  var _super = _createSuper(ActivityScreen);\n\n  function ActivityScreen(props) {\n    var _this;\n\n    _classCallCheck(this, ActivityScreen);\n\n    _this = _super.call(this, props);\n\n    _this.handleRedirect = function (suspended, child_id) {\n      var history = _this.props.history;\n\n      if (!suspended) {\n        history.push(\"/profiles/groupmember/children/\".concat(child_id));\n      }\n    };\n\n    _this.renderList = function (list, type) {\n      var classes = _this.props.classes;\n      return list.map(function (profile, index) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: index,\n          style: {\n            display: \"block\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 7\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"row\",\n          style: {\n            margin: \"1rem 0\"\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 9\n          }\n        }, /*#__PURE__*/React.createElement(Avatar, {\n          route: type === \"parents\" ? \"/profiles/groupmember/children/\".concat(profile.child_id) : \"/profiles/\".concat(profile.user_id, \"/info\"),\n          className: classes.avatar,\n          thumbnail: path(profile, [\"image\", \"path\"]),\n          disabled: profile.suspended,\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 11\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          role: \"button\",\n          tabIndex: -42,\n          className: \"participantsText\",\n          onClick: function onClick() {\n            return _this.handleRedirect(profile.suspended, profile.child_id);\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 11\n          }\n        }, \"\".concat(profile.given_name, \" \").concat(profile.family_name))));\n      });\n    };\n\n    _this.renderParticipants = function (type) {\n      var _this$state = _this.state,\n          _this$state$activity = _this$state.activity,\n          children = _this$state$activity.children,\n          parents = _this$state$activity.parents,\n          showVolunteers = _this$state.showVolunteers,\n          showChildren = _this$state.showChildren;\n      var language = _this.props.language;\n      var texts = Texts[language].activityScreen;\n      var rowStyle = {\n        minHeight: \"5rem\"\n      };\n      var showParticipants = type === \"volunteers\" ? showVolunteers : showChildren;\n      var stateProperty = type === \"volunteers\" ? \"showVolunteers\" : \"showChildren\";\n      var profiles = type === \"volunteers\" ? parents : children;\n      return /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 243,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }\n      }, type === \"volunteers\" ? /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-user-friends\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 15\n        }\n      }) : /*#__PURE__*/React.createElement(\"img\", {\n        src: Images.babyFace,\n        alt: \"map marker icon\",\n        className: \"activityInfoImage\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 248,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-8-10\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 13\n        }\n      }, texts[type])), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton participantsHeaderButton\",\n        onClick: function onClick() {\n          return _this.setState(_defineProperty({}, stateProperty, !showParticipants));\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: showParticipants ? \"fas fa-chevron-up activityInfoIcon\" : \"fas fa-chevron-down activityInfoIcon\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 15\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: showParticipants ? rowStyle : {\n          display: \"none\"\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 282,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-9-10\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 283,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"participantsContainer\",\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"ul\", {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 15\n        }\n      }, _this.renderList(profiles, type))))));\n    };\n\n    _this.addActivity = function () {\n      var history = _this.props.history;\n      var pathname = history.location.pathname;\n      history.push(\"\".concat(pathname, \"/timeslots/add\"));\n    };\n\n    _this.getDatesString = function () {\n      var language = _this.props.language;\n      var activity = _this.state.activity;\n      var selectedDates = activity.dates;\n      var texts = Texts[language].activityScreen;\n      var datesString = \"\";\n\n      if (activity.repetition_type === \"monthly\") {\n        datesString = \"\".concat(texts.every, \" \").concat(moment(selectedDates[0]).format(\"Do\"));\n      } else if (activity.repetition_type === \"weekly\") {\n        datesString = \"\".concat(texts.every, \" \").concat(moment(selectedDates[0]).format(\"dddd\"), \" \").concat(texts.of, \" \").concat(moment(selectedDates[0]).format(\"MMMM\"));\n      } else {\n        selectedDates.forEach(function (selectedDate) {\n          datesString += \"\".concat(moment(selectedDate).format(\"D\"), \", \");\n        });\n        datesString = datesString.slice(0, datesString.lastIndexOf(\",\"));\n        datesString += \" \".concat(moment(selectedDates[0]).format(\"MMMM YYYY\"));\n      }\n\n      return datesString;\n    };\n\n    _this.handleEdit = function () {\n      var history = _this.props.history;\n      var pathname = history.location.pathname;\n      pathname = \"\".concat(pathname, \"/edit\");\n      history.push(pathname);\n    };\n\n    _this.handleConfirmDialogOpen = function (action) {\n      _this.setState({\n        confirmDialogIsOpen: true,\n        optionsModalIsOpen: false,\n        action: action\n      });\n    };\n\n    _this.handleConfirmDialogClose = function (choice) {\n      var action = _this.state.action;\n\n      if (choice === \"agree\") {\n        switch (action) {\n          case \"delete\":\n            _this.handleDelete();\n\n            break;\n\n          case \"exportPdf\":\n            _this.handleExport(\"pdf\");\n\n            break;\n\n          case \"exportExcel\":\n            _this.handleExport(\"excel\");\n\n            break;\n\n          default:\n        }\n      }\n\n      _this.setState({\n        confirmDialogIsOpen: false\n      });\n    };\n\n    _this.handleOptions = function () {\n      var optionsModalIsOpen = _this.state.optionsModalIsOpen;\n\n      _this.setState({\n        optionsModalIsOpen: !optionsModalIsOpen\n      });\n    };\n\n    _this.handleOptionsClose = function () {\n      _this.setState({\n        optionsModalIsOpen: false\n      });\n    };\n\n    _this.handleDelete = function () {\n      var _this$props = _this.props,\n          match = _this$props.match,\n          history = _this$props.history;\n      var _match$params = match.params,\n          groupId = _match$params.groupId,\n          activityId = _match$params.activityId;\n\n      _this.setState({\n        pendingRequest: true\n      });\n\n      axios.delete(\"/api/groups/\".concat(groupId, \"/activities/\").concat(activityId)).then(function (response) {\n        Log.info(response);\n        history.goBack();\n      }).catch(function (error) {\n        Log.error(error);\n        history.goBack();\n      });\n    };\n\n    _this.handleExport = function (format) {\n      var _this$props2 = _this.props,\n          match = _this$props2.match,\n          enqueueSnackbar = _this$props2.enqueueSnackbar,\n          language = _this$props2.language;\n      var texts = Texts[language].activityScreen;\n      var snackMessage = texts[\"\".concat(format, \"Toaster\")];\n      var _match$params2 = match.params,\n          activityId = _match$params2.activityId,\n          groupId = _match$params2.groupId;\n      axios.post(\"/api/groups/\".concat(groupId, \"/activities/\").concat(activityId, \"/export\"), {\n        format: format\n      }).then(function (response) {\n        enqueueSnackbar(snackMessage, {\n          variant: \"info\"\n        });\n        Log.info(response);\n      }).catch(function (error) {\n        Log.error(error);\n      });\n    };\n\n    var _match = _this.props.match;\n    var _match$params3 = _match.params,\n        _groupId = _match$params3.groupId,\n        _activityId = _match$params3.activityId;\n    _this.state = {\n      fetchedActivityData: false,\n      pendingRequest: false,\n      activity: {},\n      confirmDialogIsOpen: false,\n      userCanEdit: false,\n      optionsModalIsOpen: false,\n      action: \"\",\n      showVolunteers: false,\n      showChildren: false,\n      groupId: _groupId,\n      activityId: _activityId\n    };\n    return _this;\n  }\n\n  _createClass(ActivityScreen, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _this$state2, groupId, activityId, userId, activity, childIds, parentIds, childUniqueIds, parentUniqueIds, dates, uniqueDates, temp, groupMembers, userIsAdmin, userIsCreator, userCanEdit;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this$state2 = this.state, groupId = _this$state2.groupId, activityId = _this$state2.activityId;\n                userId = JSON.parse(localStorage.getItem(\"user\")).id;\n                _context.next = 4;\n                return getActivity(activityId, groupId);\n\n              case 4:\n                activity = _context.sent;\n                _context.next = 7;\n                return getActivityTimeslots(activityId, groupId);\n\n              case 7:\n                activity.timeslots = _context.sent;\n                childIds = [];\n                parentIds = [];\n                activity.timeslots.forEach(function (timeslot) {\n                  var childParticipants = JSON.parse(timeslot.extendedProperties.shared.children);\n                  var parentParticipants = JSON.parse(timeslot.extendedProperties.shared.parents);\n                  childIds = childIds.concat(childParticipants);\n                  parentIds = parentIds.concat(parentParticipants);\n                });\n                childUniqueIds = _toConsumableArray(new Set(childIds));\n                parentUniqueIds = _toConsumableArray(new Set(parentIds));\n                _context.next = 15;\n                return getActivityChildren(childUniqueIds);\n\n              case 15:\n                activity.children = _context.sent;\n                _context.next = 18;\n                return getActivityParents(parentUniqueIds);\n\n              case 18:\n                activity.parents = _context.sent;\n                activity.children = activity.children.sort(function (a, b) {\n                  return \"\".concat(a.given_name, \" \").concat(a.family_name) - \"\".concat(b.given_name, \" \").concat(b.family_name);\n                });\n                activity.parents = activity.parents.sort(function (a, b) {\n                  return \"\".concat(a.given_name, \" \").concat(a.family_name) - \"\".concat(b.given_name, \" \").concat(b.family_name);\n                });\n                dates = activity.timeslots.map(function (timeslot) {\n                  return timeslot.start.dateTime;\n                });\n                dates = dates.sort(function (a, b) {\n                  return new Date(a) - new Date(b);\n                });\n                uniqueDates = [];\n                temp = [];\n                dates.forEach(function (date) {\n                  var t = moment(date).format(\"DD-MM-YYYY\");\n\n                  if (!temp.includes(t)) {\n                    temp.push(t);\n                    uniqueDates.push(date);\n                  }\n                });\n                activity.dates = uniqueDates;\n                _context.next = 29;\n                return getGroupMembers(groupId);\n\n              case 29:\n                groupMembers = _context.sent;\n                userIsAdmin = groupMembers.filter(function (member) {\n                  return member.user_id === userId && member.group_accepted && member.user_accepted;\n                })[0].admin;\n                userIsCreator = userId === activity.creator_id;\n                userCanEdit = userIsAdmin || userIsCreator;\n                this.setState({\n                  activity: activity,\n                  fetchedActivityData: true,\n                  userCanEdit: userCanEdit\n                });\n\n              case 34:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props3 = this.props,\n          history = _this$props3.history,\n          language = _this$props3.language,\n          classes = _this$props3.classes;\n      var _this$state3 = this.state,\n          activity = _this$state3.activity,\n          fetchedActivityData = _this$state3.fetchedActivityData,\n          userCanEdit = _this$state3.userCanEdit,\n          action = _this$state3.action,\n          confirmDialogIsOpen = _this$state3.confirmDialogIsOpen,\n          optionsModalIsOpen = _this$state3.optionsModalIsOpen,\n          pendingRequest = _this$state3.pendingRequest;\n      var texts = Texts[language].activityScreen;\n      var options = [{\n        label: texts.delete,\n        style: \"optionsModalButton\",\n        handle: function handle() {\n          _this2.handleConfirmDialogOpen(\"delete\");\n        }\n      }, {\n        label: texts.exportPdf,\n        style: \"optionsModalButton\",\n        handle: function handle() {\n          _this2.handleConfirmDialogOpen(\"exportPdf\");\n        }\n      }, {\n        label: texts.exportExcel,\n        style: \"optionsModalButton\",\n        handle: function handle() {\n          _this2.handleConfirmDialogOpen(\"exportExcel\");\n        }\n      }];\n      var confirmDialogTitle = action === \"delete\" ? texts.deleteDialogTitle : texts.exportDialogTitle;\n      var rowStyle = {\n        minHeight: \"5rem\"\n      };\n      return fetchedActivityData ? /*#__PURE__*/React.createElement(React.Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 7\n        }\n      }, pendingRequest && /*#__PURE__*/React.createElement(LoadingSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 28\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(ConfirmDialog, {\n        title: confirmDialogTitle,\n        isOpen: confirmDialogIsOpen,\n        handleClose: this.handleConfirmDialogClose,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 442,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(OptionsModal, {\n        isOpen: optionsModalIsOpen,\n        handleClose: this.handleOptionsClose,\n        options: options,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 447,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityHeaderContainer\",\n        className: \"row no-gutters\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 452,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-2-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 453,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: function onClick() {\n          return history.goBack();\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-arrow-left\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 17\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-6-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 462,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"h1\", {\n        className: \"center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 15\n        }\n      }, activity.name)), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 465,\n          columnNumber: 13\n        }\n      }, userCanEdit ? /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: this.handleEdit,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-pencil-alt\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 19\n        }\n      })) : /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 475,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 478,\n          columnNumber: 13\n        }\n      }, userCanEdit ? /*#__PURE__*/React.createElement(\"button\", {\n        type: \"button\",\n        className: \"transparentButton center\",\n        onClick: this.handleOptions,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 480,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-ellipsis-v\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 19\n        }\n      })) : /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 488,\n          columnNumber: 17\n        }\n      }))), /*#__PURE__*/React.createElement(\"div\", {\n        id: \"activityMainContainer\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 492,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoHeader\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 494,\n          columnNumber: 15\n        }\n      }, texts.infoHeader)), activity.description && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-file-alt activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 499,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-9-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 502,\n          columnNumber: 19\n        }\n      }, activity.description))), activity.location && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 509,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 510,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: Images.mapMarkerAltRegular,\n        alt: \"map marker icon\",\n        className: \"activityInfoImage\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 511,\n          columnNumber: 19\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-9-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 517,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 19\n        }\n      }, activity.location))), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"row no-gutters\",\n        style: rowStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 524,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-1-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 525,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"far fa-calendar activityInfoIcon\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 526,\n          columnNumber: 17\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"col-9-10\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 528,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"activityInfoDescription\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 529,\n          columnNumber: 17\n        }\n      }, this.getDatesString()))), this.renderParticipants(\"volunteers\"), this.renderParticipants(\"children\"))), /*#__PURE__*/React.createElement(Fab, {\n        color: \"primary\",\n        \"aria-label\": \"Add\",\n        className: classes.add,\n        onClick: this.addActivity,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 538,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fas fa-plus\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 544,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(TimeslotsList, {\n        dates: activity.dates,\n        timeslots: activity.timeslots,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 9\n        }\n      })) : /*#__PURE__*/React.createElement(LoadingSpinner, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 549,\n          columnNumber: 7\n        }\n      });\n    }\n  }]);\n\n  return ActivityScreen;\n}(React.Component);\n\nexport default withSnackbar(withStyles(styles)(withLanguage(ActivityScreen)));\nActivityScreen.propTypes = {\n  history: PropTypes.object,\n  language: PropTypes.string,\n  match: PropTypes.object,\n  classes: PropTypes.object,\n  enqueueSnackbar: PropTypes.func\n};","map":{"version":3,"sources":["C:/Users/nucle/Documents/GitHub/Green-Wizards/client/src/components/ActivityScreen.js"],"names":["React","axios","moment","PropTypes","Fab","withStyles","path","withSnackbar","Texts","withLanguage","TimeslotsList","ConfirmDialog","OptionsModal","LoadingSpinner","Images","Log","Avatar","styles","add","position","bottom","right","height","width","borderRadius","border","backgroundColor","zIndex","fontSize","avatar","getActivityTimeslots","activityId","groupId","get","then","response","data","catch","error","getActivity","name","description","color","group_name","location","dates","repetition_type","getGroupMembers","getActivityChildren","ids","params","searchBy","getActivityParents","ActivityScreen","props","handleRedirect","suspended","child_id","history","push","renderList","list","type","classes","map","profile","index","display","margin","user_id","given_name","family_name","renderParticipants","state","activity","children","parents","showVolunteers","showChildren","language","texts","activityScreen","rowStyle","minHeight","showParticipants","stateProperty","profiles","babyFace","setState","addActivity","pathname","getDatesString","selectedDates","datesString","every","format","of","forEach","selectedDate","slice","lastIndexOf","handleEdit","handleConfirmDialogOpen","action","confirmDialogIsOpen","optionsModalIsOpen","handleConfirmDialogClose","choice","handleDelete","handleExport","handleOptions","handleOptionsClose","match","pendingRequest","delete","info","goBack","enqueueSnackbar","snackMessage","post","variant","fetchedActivityData","userCanEdit","userId","JSON","parse","localStorage","getItem","id","timeslots","childIds","parentIds","timeslot","childParticipants","extendedProperties","shared","parentParticipants","concat","childUniqueIds","Set","parentUniqueIds","sort","a","b","start","dateTime","Date","uniqueDates","temp","date","t","includes","groupMembers","userIsAdmin","filter","member","group_accepted","user_accepted","admin","userIsCreator","creator_id","options","label","style","handle","exportPdf","exportExcel","confirmDialogTitle","deleteDialogTitle","exportDialogTitle","infoHeader","mapMarkerAltRegular","Component","propTypes","object","string","func"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport moment from \"moment\";\r\nimport PropTypes from \"prop-types\";\r\nimport Fab from \"@material-ui/core/Fab\";\r\nimport { withStyles } from \"@material-ui/core/styles\";\r\nimport * as path from \"lodash.get\";\r\nimport { withSnackbar } from \"notistack\";\r\nimport Texts from \"../Constants/Texts\";\r\nimport withLanguage from \"./LanguageContext\";\r\nimport TimeslotsList from \"./TimeslotsList\";\r\nimport ConfirmDialog from \"./ConfirmDialog\";\r\nimport OptionsModal from \"./OptionsModal\";\r\nimport LoadingSpinner from \"./LoadingSpinner\";\r\nimport Images from \"../Constants/Images\";\r\nimport Log from \"./Log\";\r\nimport Avatar from \"./Avatar\";\r\n\r\nconst styles = {\r\n  add: {\r\n    position: \"fixed\",\r\n    bottom: \"3rem\",\r\n    right: \"5%\",\r\n    height: \"5rem\",\r\n    width: \"5rem\",\r\n    borderRadius: \"50%\",\r\n    border: \"solid 0.5px #999\",\r\n    backgroundColor: \"#ff6f00\",\r\n    zIndex: 100,\r\n    fontSize: \"2rem\"\r\n  },\r\n  avatar: {\r\n    width: \"3rem!important\",\r\n    height: \"3rem!important\"\r\n  }\r\n};\r\n\r\nconst getActivityTimeslots = (activityId, groupId) => {\r\n  return axios\r\n    .get(`/api/groups/${groupId}/activities/${activityId}/timeslots`)\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getActivity = (activityId, groupId) => {\r\n  return axios\r\n    .get(`/api/groups/${groupId}/activities/${activityId}`)\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return {\r\n        name: \"\",\r\n        description: \"\",\r\n        color: \"#ffffff\",\r\n        group_name: \"\",\r\n        location: \"\",\r\n        dates: [],\r\n        repetition_type: \"\"\r\n      };\r\n    });\r\n};\r\nconst getGroupMembers = groupId => {\r\n  return axios\r\n    .get(`/api/groups/${groupId}/members`)\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getActivityChildren = ids => {\r\n  return axios\r\n    .get(\"/api/children\", {\r\n      params: {\r\n        ids,\r\n        searchBy: \"ids\"\r\n      }\r\n    })\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nconst getActivityParents = ids => {\r\n  return axios\r\n    .get(\"/api/profiles\", {\r\n      params: {\r\n        ids,\r\n        searchBy: \"ids\"\r\n      }\r\n    })\r\n    .then(response => {\r\n      return response.data;\r\n    })\r\n    .catch(error => {\r\n      Log.error(error);\r\n      return [];\r\n    });\r\n};\r\n\r\nclass ActivityScreen extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    const { match } = this.props;\r\n    const { groupId, activityId } = match.params;\r\n    this.state = {\r\n      fetchedActivityData: false,\r\n      pendingRequest: false,\r\n      activity: {},\r\n      confirmDialogIsOpen: false,\r\n      userCanEdit: false,\r\n      optionsModalIsOpen: false,\r\n      action: \"\",\r\n      showVolunteers: false,\r\n      showChildren: false,\r\n      groupId,\r\n      activityId\r\n    };\r\n  }\r\n\r\n  async componentDidMount() {\r\n    const { groupId, activityId } = this.state;\r\n    const userId = JSON.parse(localStorage.getItem(\"user\")).id;\r\n    const activity = await getActivity(activityId, groupId);\r\n    activity.timeslots = await getActivityTimeslots(activityId, groupId);\r\n    let childIds = [];\r\n    let parentIds = [];\r\n    activity.timeslots.forEach(timeslot => {\r\n      const childParticipants = JSON.parse(\r\n        timeslot.extendedProperties.shared.children\r\n      );\r\n      const parentParticipants = JSON.parse(\r\n        timeslot.extendedProperties.shared.parents\r\n      );\r\n      childIds = childIds.concat(childParticipants);\r\n      parentIds = parentIds.concat(parentParticipants);\r\n    });\r\n    const childUniqueIds = [...new Set(childIds)];\r\n    const parentUniqueIds = [...new Set(parentIds)];\r\n    activity.children = await getActivityChildren(childUniqueIds);\r\n    activity.parents = await getActivityParents(parentUniqueIds);\r\n    activity.children = activity.children.sort(\r\n      (a, b) =>\r\n        `${a.given_name} ${a.family_name}` - `${b.given_name} ${b.family_name}`\r\n    );\r\n    activity.parents = activity.parents.sort(\r\n      (a, b) =>\r\n        `${a.given_name} ${a.family_name}` - `${b.given_name} ${b.family_name}`\r\n    );\r\n    let dates = activity.timeslots.map(timeslot => timeslot.start.dateTime);\r\n    dates = dates.sort((a, b) => {\r\n      return new Date(a) - new Date(b);\r\n    });\r\n    const uniqueDates = [];\r\n    const temp = [];\r\n    dates.forEach(date => {\r\n      const t = moment(date).format(\"DD-MM-YYYY\");\r\n      if (!temp.includes(t)) {\r\n        temp.push(t);\r\n        uniqueDates.push(date);\r\n      }\r\n    });\r\n    activity.dates = uniqueDates;\r\n    const groupMembers = await getGroupMembers(groupId);\r\n    const userIsAdmin = groupMembers.filter(\r\n      member =>\r\n        member.user_id === userId &&\r\n        member.group_accepted &&\r\n        member.user_accepted\r\n    )[0].admin;\r\n    const userIsCreator = userId === activity.creator_id;\r\n    const userCanEdit = userIsAdmin || userIsCreator;\r\n    this.setState({ activity, fetchedActivityData: true, userCanEdit });\r\n  }\r\n\r\n  handleRedirect = (suspended, child_id) => {\r\n    const { history } = this.props;\r\n    if (!suspended) {\r\n      history.push(`/profiles/groupmember/children/${child_id}`);\r\n    }\r\n  };\r\n\r\n  renderList = (list, type) => {\r\n    const { classes } = this.props;\r\n    return list.map((profile, index) => (\r\n      <li key={index} style={{ display: \"block\" }}>\r\n        <div className=\"row\" style={{ margin: \"1rem 0\" }}>\r\n          <Avatar\r\n            route={\r\n              type === \"parents\"\r\n                ? `/profiles/groupmember/children/${profile.child_id}`\r\n                : `/profiles/${profile.user_id}/info`\r\n            }\r\n            className={classes.avatar}\r\n            thumbnail={path(profile, [\"image\", \"path\"])}\r\n            disabled={profile.suspended}\r\n          />\r\n          <div\r\n            role=\"button\"\r\n            tabIndex={-42}\r\n            className=\"participantsText\"\r\n            onClick={() =>\r\n              this.handleRedirect(profile.suspended, profile.child_id)\r\n            }\r\n          >\r\n            {`${profile.given_name} ${profile.family_name}`}\r\n          </div>\r\n        </div>\r\n      </li>\r\n    ));\r\n  };\r\n\r\n  renderParticipants = type => {\r\n    const {\r\n      activity: { children, parents },\r\n      showVolunteers,\r\n      showChildren\r\n    } = this.state;\r\n    const { language } = this.props;\r\n    const texts = Texts[language].activityScreen;\r\n    const rowStyle = { minHeight: \"5rem\" };\r\n    const showParticipants =\r\n      type === \"volunteers\" ? showVolunteers : showChildren;\r\n    const stateProperty =\r\n      type === \"volunteers\" ? \"showVolunteers\" : \"showChildren\";\r\n    const profiles = type === \"volunteers\" ? parents : children;\r\n    return (\r\n      <React.Fragment>\r\n        <div className=\"row no-gutters\" style={rowStyle}>\r\n          <div className=\"col-1-10\">\r\n            {type === \"volunteers\" ? (\r\n              <i className=\"fas fa-user-friends\" />\r\n            ) : (\r\n              <img\r\n                src={Images.babyFace}\r\n                alt=\"map marker icon\"\r\n                className=\"activityInfoImage\"\r\n              />\r\n            )}\r\n          </div>\r\n          <div className=\"col-8-10\">\r\n            <div className=\"activityInfoDescription\">{texts[type]}</div>\r\n          </div>\r\n          <div className=\"col-1-10\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"transparentButton participantsHeaderButton\"\r\n              onClick={() =>\r\n                this.setState({\r\n                  [stateProperty]: !showParticipants\r\n                })\r\n              }\r\n            >\r\n              <i\r\n                className={\r\n                  showParticipants\r\n                    ? \"fas fa-chevron-up activityInfoIcon\"\r\n                    : \"fas fa-chevron-down activityInfoIcon\"\r\n                }\r\n              />\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div\r\n          className=\"row no-gutters\"\r\n          style={showParticipants ? rowStyle : { display: \"none\" }}\r\n        >\r\n          <div className=\"col-1-10\" />\r\n          <div className=\"col-9-10\">\r\n            <div className=\"participantsContainer\">\r\n              <ul>{this.renderList(profiles, type)}</ul>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </React.Fragment>\r\n    );\r\n  };\r\n\r\n  addActivity = () => {\r\n    const { history } = this.props;\r\n    const { pathname } = history.location;\r\n    history.push(`${pathname}/timeslots/add`);\r\n  };\r\n\r\n  getDatesString = () => {\r\n    const { language } = this.props;\r\n    const { activity } = this.state;\r\n    const selectedDates = activity.dates;\r\n    const texts = Texts[language].activityScreen;\r\n    let datesString = \"\";\r\n    if (activity.repetition_type === \"monthly\") {\r\n      datesString = `${texts.every} ${moment(selectedDates[0]).format(\"Do\")}`;\r\n    } else if (activity.repetition_type === \"weekly\") {\r\n      datesString = `${texts.every} ${moment(selectedDates[0]).format(\r\n        \"dddd\"\r\n      )} ${texts.of} ${moment(selectedDates[0]).format(\"MMMM\")}`;\r\n    } else {\r\n      selectedDates.forEach(selectedDate => {\r\n        datesString += `${moment(selectedDate).format(\"D\")}, `;\r\n      });\r\n      datesString = datesString.slice(0, datesString.lastIndexOf(\",\"));\r\n      datesString += ` ${moment(selectedDates[0]).format(\"MMMM YYYY\")}`;\r\n    }\r\n    return datesString;\r\n  };\r\n\r\n  handleEdit = () => {\r\n    const { history } = this.props;\r\n    let { pathname } = history.location;\r\n    pathname = `${pathname}/edit`;\r\n    history.push(pathname);\r\n  };\r\n\r\n  handleConfirmDialogOpen = action => {\r\n    this.setState({\r\n      confirmDialogIsOpen: true,\r\n      optionsModalIsOpen: false,\r\n      action\r\n    });\r\n  };\r\n\r\n  handleConfirmDialogClose = choice => {\r\n    const { action } = this.state;\r\n    if (choice === \"agree\") {\r\n      switch (action) {\r\n        case \"delete\":\r\n          this.handleDelete();\r\n          break;\r\n        case \"exportPdf\":\r\n          this.handleExport(\"pdf\");\r\n          break;\r\n        case \"exportExcel\":\r\n          this.handleExport(\"excel\");\r\n          break;\r\n        default:\r\n      }\r\n    }\r\n    this.setState({ confirmDialogIsOpen: false });\r\n  };\r\n\r\n  handleOptions = () => {\r\n    const { optionsModalIsOpen } = this.state;\r\n    this.setState({ optionsModalIsOpen: !optionsModalIsOpen });\r\n  };\r\n\r\n  handleOptionsClose = () => {\r\n    this.setState({ optionsModalIsOpen: false });\r\n  };\r\n\r\n  handleDelete = () => {\r\n    const { match, history } = this.props;\r\n    const { groupId, activityId } = match.params;\r\n    this.setState({pendingRequest: true})\r\n    axios\r\n      .delete(`/api/groups/${groupId}/activities/${activityId}`)\r\n      .then(response => {\r\n        Log.info(response);\r\n        history.goBack();\r\n      })\r\n      .catch(error => {\r\n        Log.error(error);\r\n        history.goBack();\r\n      });\r\n  };\r\n\r\n  handleExport = format => {\r\n    const { match, enqueueSnackbar, language } = this.props;\r\n    const texts = Texts[language].activityScreen;\r\n    const snackMessage = texts[`${format}Toaster`];\r\n    const { activityId, groupId } = match.params;\r\n    axios\r\n      .post(`/api/groups/${groupId}/activities/${activityId}/export`, {\r\n        format\r\n      })\r\n      .then(response => {\r\n        enqueueSnackbar(snackMessage, {\r\n          variant: \"info\"\r\n        });\r\n        Log.info(response);\r\n      })\r\n      .catch(error => {\r\n        Log.error(error);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const { history, language, classes } = this.props;\r\n    const {\r\n      activity,\r\n      fetchedActivityData,\r\n      userCanEdit,\r\n      action,\r\n      confirmDialogIsOpen,\r\n      optionsModalIsOpen,\r\n      pendingRequest\r\n    } = this.state;\r\n    const texts = Texts[language].activityScreen;\r\n    const options = [\r\n      {\r\n        label: texts.delete,\r\n        style: \"optionsModalButton\",\r\n        handle: () => {\r\n          this.handleConfirmDialogOpen(\"delete\");\r\n        }\r\n      },\r\n      {\r\n        label: texts.exportPdf,\r\n        style: \"optionsModalButton\",\r\n        handle: () => {\r\n          this.handleConfirmDialogOpen(\"exportPdf\");\r\n        }\r\n      },\r\n      {\r\n        label: texts.exportExcel,\r\n        style: \"optionsModalButton\",\r\n        handle: () => {\r\n          this.handleConfirmDialogOpen(\"exportExcel\");\r\n        }\r\n      }\r\n    ];\r\n    const confirmDialogTitle =\r\n      action === \"delete\" ? texts.deleteDialogTitle : texts.exportDialogTitle;\r\n    const rowStyle = { minHeight: \"5rem\" };\r\n    return fetchedActivityData ? (\r\n      <React.Fragment>\r\n        {pendingRequest && <LoadingSpinner/>}\r\n        <div id=\"activityContainer\">\r\n          <ConfirmDialog\r\n            title={confirmDialogTitle}\r\n            isOpen={confirmDialogIsOpen}\r\n            handleClose={this.handleConfirmDialogClose}\r\n          />\r\n          <OptionsModal\r\n            isOpen={optionsModalIsOpen}\r\n            handleClose={this.handleOptionsClose}\r\n            options={options}\r\n          />\r\n          <div id=\"activityHeaderContainer\" className=\"row no-gutters\">\r\n            <div className=\"col-2-10\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"transparentButton center\"\r\n                onClick={() => history.goBack()}\r\n              >\r\n                <i className=\"fas fa-arrow-left\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"col-6-10\">\r\n              <h1 className=\"center\">{activity.name}</h1>\r\n            </div>\r\n            <div className=\"col-1-10\">\r\n              {userCanEdit ? (\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"transparentButton center\"\r\n                  onClick={this.handleEdit}\r\n                >\r\n                  <i className=\"fas fa-pencil-alt\" />\r\n                </button>\r\n              ) : (\r\n                <div />\r\n              )}\r\n            </div>\r\n            <div className=\"col-1-10\">\r\n              {userCanEdit ? (\r\n                <button\r\n                  type=\"button\"\r\n                  className=\"transparentButton center\"\r\n                  onClick={this.handleOptions}\r\n                >\r\n                  <i className=\"fas fa-ellipsis-v\" />\r\n                </button>\r\n              ) : (\r\n                <div />\r\n              )}\r\n            </div>\r\n          </div>\r\n          <div id=\"activityMainContainer\">\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"activityInfoHeader\">{texts.infoHeader}</div>\r\n            </div>\r\n            {activity.description && (\r\n              <div className=\"row no-gutters\" style={rowStyle}>\r\n                <div className=\"col-1-10\">\r\n                  <i className=\"far fa-file-alt activityInfoIcon\" />\r\n                </div>\r\n                <div className=\"col-9-10\">\r\n                  <div className=\"activityInfoDescription\">\r\n                    {activity.description}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            {activity.location && (\r\n              <div className=\"row no-gutters\" style={rowStyle}>\r\n                <div className=\"col-1-10\">\r\n                  <img\r\n                    src={Images.mapMarkerAltRegular}\r\n                    alt=\"map marker icon\"\r\n                    className=\"activityInfoImage\"\r\n                  />\r\n                </div>\r\n                <div className=\"col-9-10\">\r\n                  <div className=\"activityInfoDescription\">\r\n                    {activity.location}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            )}\r\n            <div className=\"row no-gutters\" style={rowStyle}>\r\n              <div className=\"col-1-10\">\r\n                <i className=\"far fa-calendar activityInfoIcon\" />\r\n              </div>\r\n              <div className=\"col-9-10\">\r\n                <div className=\"activityInfoDescription\">\r\n                  {this.getDatesString()}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            {this.renderParticipants(\"volunteers\")}\r\n            {this.renderParticipants(\"children\")}\r\n          </div>\r\n        </div>\r\n        <Fab\r\n          color=\"primary\"\r\n          aria-label=\"Add\"\r\n          className={classes.add}\r\n          onClick={this.addActivity}\r\n        >\r\n          <i className=\"fas fa-plus\" />\r\n        </Fab>\r\n        <TimeslotsList dates={activity.dates} timeslots={activity.timeslots} />\r\n      </React.Fragment>\r\n    ) : (\r\n      <LoadingSpinner />\r\n    );\r\n  }\r\n}\r\n\r\nexport default withSnackbar(withStyles(styles)(withLanguage(ActivityScreen)));\r\n\r\nActivityScreen.propTypes = {\r\n  history: PropTypes.object,\r\n  language: PropTypes.string,\r\n  match: PropTypes.object,\r\n  classes: PropTypes.object,\r\n  enqueueSnackbar: PropTypes.func\r\n};\r\n"]},"metadata":{},"sourceType":"module"}